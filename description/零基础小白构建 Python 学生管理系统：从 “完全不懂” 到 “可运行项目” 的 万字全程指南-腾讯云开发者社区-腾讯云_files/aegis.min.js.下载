/**
 *  ===========================================================================
 * @tencent/aegis-web-sdk@1.43.47 (c) 2025 TencentCloud Real User Monitoring.
 * Author pumpkincai.
 * Last Release Time Thu Nov 20 2025 15:18:05 GMT+0800 (GMT+08:00).
 * Released under the MIT License.
 * Thanks for supporting RUM & Aegis!
 * ===========================================================================
 **/
((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Aegis=t()})(this,function(){var k,I;function A(e){this.name="__st"+(1e9*Math.random()>>>0)+k+"__",null!=e&&e.forEach(this.add,this),k+=1}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{configurable:!0,writable:!0,value:function(e){if(null===this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o+=1}}}),window.WeakSet||(k=Date.now()%1e9,A.prototype.add=function(e){var t=this.name;return e[t]||Object.defineProperty(e,t,{value:!0,writable:!0}),this},A.prototype.delete=function(e){return!!e[this.name]&&!(e[this.name]=void 0)},A.prototype.has=function(e){return!!e[this.name]},I=A,Object.defineProperty(window,"WeakSet",{value:function(e){return new I(e)}})),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++)if(null!=(r=arguments[n]))for(var r=Object(r),o=Object.keys(Object(r)),i=0,a=o.length;i<a;i++){var s=o[i],l=Object.getOwnPropertyDescriptor(r,s);null!=l&&l.enumerable&&(t[s]=r[s])}return t}});var M=function(e,t){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},V=function(){return(V=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function pe(e,a,s,l){return new(s=s||Promise)(function(n,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function o(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((l=l.apply(e,a||[])).next())})}function he(r,o){var i,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!((s=0<(s=l.trys).length&&s[s.length-1])||6!==t[0]&&2!==t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=o.call(r,l)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var X,m,d,N=/_?t(\d)?(imestamp)?=\d+&?/g,F=["aegis.qq.com","tamaegis.com","/aegis-sdk","rumt-","/flog.core.min.js","pingfore.qq.com","pingfore.tencent.com","zhiyan.tencent-cloud.net","h.trace.qq.com","btrace.qq.com","beacon.qq.com","dmplog.qq.com","qq.com/report","svibeacon.onezapp.com","cube.weixinbridge.com","doubleclick.net","pcmgrmonitor.3g.qq.com","tdm.qq.com","report.qqweb.qq.com","tpstelemetry.tencent.com","galileotelemetry.tencent.com","insight.cloud.tencent.com","facebook.com","facebook.net","google","yahoo.com","twitter.com","ga-audiences","report.idqqimg.com","arms-retcode.aliyuncs.com","px.effirst.com","sentry","baidu.com","hot-update.json","u.c.b.r.o.w.s.e.r","report.url.cn","sockjs-node","m3u8","flv"],_=["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Failed to execute 'transaction'","window.indexedDB.deleteDatabase is not a function"],H=["ext1","ext2","ext3","ext4","ext5","ext6","ext7","ext8","ext9","ext10","level","trace","tag","seq","code"],U=["static","fetch"],S="unknown";(e=X=X||{}).INFO_ALL="-1",e.API_RESPONSE="1",e.INFO="2",e.ERROR="4",e.PROMISE_ERROR="8",e.AJAX_ERROR="16",e.SCRIPT_ERROR="32",e.IMAGE_ERROR="64",e.CSS_ERROR="128",e.CONSOLE_ERROR="256",e.MEDIA_ERROR="512",e.RET_ERROR="1024",e.PAGE_LOAD="1025",e.SLOW_PAGE_LOAD="1026",e.SLOW_NET_REQUEST="1027",e.ASSERT_REQUEST="1028",e.SLOW_ASSET_REQUEST="1029",e.CLICK_EVENT="1030",e.CONSOLE_LOG="1031",e.BLANK_SCREEN="1032",e.MEMORY_OOM="1033",e.LAG_MONITOR="1034",e.NORESPONSE_LOG="1035",e.REPORT="2048",e.PV="4096",e.EVENT="8192",e.SPEED_EVENT="8193",e.PAGE_NOT_FOUND_ERROR="16384",e.WEBSOCKET_ERROR="32768",e.BRIDGE_ERROR="65536",e.LAZY_LOAD_ERROR="131072",(e=m=m||{}).LOG="log",e.SPEED="speed",e.PERFORMANCE="performance",e.OFFLINE="offline",e.WHITE_LIST="whiteList",e.VITALS="vitals",e.PV="pv",e.CUSTOM_PV="customPV",e.EVENT="event",e.CUSTOM="custom",e.SDK_ERROR="sdkError",e.SET_DATA="setData",e.LOAD_PACKAGE="loadPackage",e.MEMORY="memory",(e=d=d||{}).production="production",e.development="development",e.gray="gray",e.pre="pre",e.daily="daily",e.local="local",e.test="test",e.others="others";W.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},W.prototype.on=function(e,t,n){var r;if(void 0===n&&(n=0),this)return(r=this.eventsList[e])||(this.eventsList[e]=[],r=this.eventsList[e]),-1===this.indexOf(r,t)&&r.push({name:e,type:n||0,callback:t}),this},W.prototype.one=function(e,t){this.on(e,t,1)},W.prototype.remove=function(e,t){if(this){var n=this.eventsList[e];if(n){if(t)return n.length&&(t=this.indexOf(n,t),n.splice(t,1)),this;try{delete this.eventsList[e]}catch(e){}}return null}},W.prototype.clear=function(){this.eventsList={}};var D,q=W,j=function(e){if(!e||0===e.length)return"{}";e=Array.isArray(e)?e:[e];var t=Array.from(new Set(e.flatMap(function(e){return Object.keys(e)}))),n={};return t.forEach(function(t){n[t]=e.map(function(e){return e[t]||""})}),n.count=e.length,ce(n)};function W(){var a=this;this.emit=function(e,t){if(a){var n;if(null!=(r=a.eventsList[e])&&r.length)for(var r=r.slice(),o=0;o<r.length;o++){n=r[o];try{var i=n.callback.apply(a,[t]);if(1===n.type&&a.remove(e,n.callback),!1===i)break}catch(e){throw e}}return a}},this.eventsList={}}(e=D=D||{})[e.number=-1]="number",e.string="";function B(e,t){return"number"==typeof e||"string"==typeof e?e:t?D.string:D.number}function G(e,t){return"string"==typeof e?e.split("?")[t?1:0]||"":e}function z(e,t){return void 0===t&&(t=2048),String(e).replace(N,"").slice(0,t)}function J(e){return"string"==typeof e&&/^\//.test(e)?"https:"===(null==location?void 0:location.protocol):/^https/.test(e)}function $(e,t,n){var r,o,i;try{if("function"==typeof(null==t?void 0:t.retCodeHandler))return{code:void 0===(i=(o=t.retCodeHandler(e,null==n?void 0:n.url,null==n?void 0:n.ctx,null==n?void 0:n.payload)||{}).code)?S:i,isErr:o.isErr};if(!(e="string"==typeof e?JSON.parse(e):e))return{code:S,isErr:!1};"function"==typeof(null==(r=null==t?void 0:t.ret)?void 0:r.join)&&(se=[].concat(t.ret.map(function(e){return e.toLowerCase()})));var a=Object.getOwnPropertyNames(e).filter(function(e){return-1!==se.indexOf(e.toLowerCase())});return a.length?{code:""+(i="未知"!==(i=e[a[0]])&&""!==i?i:S),isErr:0!==i&&"0"!==i&&i!==S}:{code:S,isErr:!1}}catch(e){return{code:S,isErr:!1}}}function K(e,t,n){try{var r="function"==typeof t?t(e,null==n?void 0:n.url,null==n?void 0:n.ctx)||"":e;return ue(r).slice(0,10240)}catch(e){return""}}function Y(e,t){var n,r={fetch:[],static:[],bridge:[]},o=new FormData;return Array.isArray(e)?e.forEach(function(e){var t=ve(e);r[e.type].push(t)}):(n=ve(e),r[e.type].push(n)),o.append("payload",ce(V({duration:r},t))),o}function Q(t,e){return"string"!=typeof t||!t||e&&-1<t.indexOf(e)||ye.test(t)||F.some(function(e){return-1<t.indexOf(e)})}function Z(n,r){var o,i=[],a=n.config;return n.lifeCycle.on("destroy",function(){i.length=0}),function(e,t){Array.isArray(e)?i=i.concat(e):i.push(e),r&&i.length>=r||n.sendNow&&0<i.length?(i=we(i),0<(i=Array.isArray(i)?i:[]).length&&t(i.splice(0,i.length)),o&&clearTimeout(o)):(o&&clearTimeout(o),o=setTimeout(function(){o=null,i=we(i),0<(i=Array.isArray(i)?i:[]).length&&t(i.splice(0,i.length))},a.delay))}}function ee(e,t){return Array.isArray(e)?t(e.map(function(e){return t=V(V({},e),{msg:"string"==typeof e.msg?e.msg:[].concat(e.msg).map(g).join(" ")}),H.forEach(function(e){t[e]||delete t[e]}),t;var t})):t([V(V({},e),{msg:"string"==typeof e.msg?e.msg:g(e.msg)})])}function te(l,c){return function(o,i){var r,a,s,e,t,n;null!=o&&o.log&&null!=o&&o.type?(r=function(e,t){var n,r,t=V(V({},l.bean),{from:t}),o=V({},l.bean);return(()=>{try{return"undefined"!=typeof FormData&&"function"==typeof FormData.prototype.append}catch(e){}})()?Y(e,t):(t=e,e=o,r={fetch:[],static:[],bridge:[]},o={},Array.isArray(t)?t.forEach(function(e){var t;null!=(t=r[e.type])&&t.push(e)}):null!=(n=r[t.type])&&n.push(t),o.payload=JSON.stringify(V({duration:r},e)),o)},a=function(e,t,n){switch(t){case m.LOG:return j(Se(e));case m.SPEED:return r(e,n);default:return{}}},1!==(e=Array.isArray(o.log)?o.log:[o.log]).length?(s={},e.forEach(function(e){var t=e.from||"undefined";delete e.from,s[t]||(s[t]=[]),s[t].push(e)}),Object.keys(s).forEach(function(e){var t,n=s[e],r=null!=(r=o.url)&&r.includes("?")?"&":"?";"undefined"===e?(t=""+o.url,i(V(V({},o),{url:t,log:1===n.length?n[0]:n,data:a(n,c,e)}))):(t=o.url+r+"from="+e,i(V(V({},o),{url:t,log:1===n.length?n[0]:n,beanFilter:u(o.beanFilter||[],["from"]),data:a(n,c,e)})))})):(t=(e=e[0]).from,delete e.from,n=null!=(n=o.url)&&n.includes("?")?"&":"?",t?(n=o.url+n+"from="+t,i(V(V({},o),{url:n,log:e,beanFilter:u(o.beanFilter||[],["from"]),data:a(e,c,t)}))):(n=""+o.url,i(V(V({},o),{url:n,log:e}))))):i(o)}}function ne(l,c){return function(e,t){var n,r,o,i=Array.isArray(e),a=i?e:[e],s=(l.lifeCycle.emit("beforeRequest",e),l.config.beforeRequest);(a="function"==typeof s?a.map(function(t){try{var e=s({logs:t,logType:c});return(null==e?void 0:e.logType)===c&&null!=e&&e.logs?e.logs:!1!==e&&t}catch(e){return t}}).filter(function(e){return!1!==e}):a).length&&(n=a,e=H,!Array.isArray(n)||n.length<=1||(r=[],o=[],!(o="string"==typeof e?[e]:e))||o.length<=0||(o.forEach(function(t){n.forEach(function(e){null!=e&&e[t]&&r.push(t)})}),0<r.length&&(n=n.map(function(e){var t={};return r.forEach(function(e){t[e]=""}),V(V({},t),e)}))),a=n,t(i?a:a[0]))}}function re(o){return function(e,t){o.lifeCycle.emit("modifyRequest",e);var n=o.config.modifyRequest;if("function"==typeof n)try{var r=n(e);"object"==typeof r&&"url"in r&&(e=r)}catch(e){console.error(e)}t(e)}}function oe(r){return function(e,t){null!=(n=r.lifeCycle)&&n.emit("afterRequest",e);var n=(r.config||{}).afterRequest;"function"==typeof n&&!1===n(e)||t(e)}}var ie=["application/xhtml+xml","application/xml","application/pdf","application/pkcs12","application/javascript","application/x-javascript","application/ecmascript","application/vnd.mspowerpoint","application/vnd.apple.mpegurl","application/ogg","text/css","text/javascript","image","audio","video","video/mp2t"],ae=/\.(json|js|css|jpg|jpeg|png|svg|apng|webp|gif|bmp|mp4|mp3|ts|mpeg|wav|webm|ogg|flv|m3u8|ttf|woff2|otf|eot|woff|html|htm|shtml|shtm|)$/i,se=["ret","retcode","code","errcode"],le=function(){var n=new WeakSet;return function(e,t){if(t instanceof Error)return"Error.message: "+t.message+" \n  Error.stack: "+t.stack;if("object"==typeof t&&null!==t){if(n.has(t))return"[Circular "+(e||"root")+"]";n.add(t)}return t}},g=function(e){if("string"==typeof e)return e;try{return e instanceof Error?(JSON.stringify(e,le(),2)||"undefined").replace(/"/gim,""):JSON.stringify(e,le(),2)||"undefined"}catch(e){return"error happen when aegis stringify: \n "+e.message+" \n "+e.stack}},ce=function(e){if("string"==typeof e)return e;try{return JSON.stringify(e,le())||"undefined"}catch(e){return"error happen when aegis stringify: \n "+e.message+" \n "+e.stack}},ue=function(n,r){void 0===r&&(r=3);var o,i,a,s="";return Array.isArray(n)?(s+="[",o=n.length,n.forEach(function(e,t){s=(s+="object"==typeof e&&1<r?ue(e,r-1):fe(e))+(t===o-1?"":",")}),s+="]"):n instanceof Object?(s="{",i=Object.keys(n),a=i.length,i.forEach(function(e,t){"object"==typeof n[e]&&1<r?s+='"'+e+'":'+ue(n[e],r-1):s+=de(e,n[e]),s+=t===a-1||t<a-1&&void 0===n[i[t+1]]?"":","}),s+="}"):s+=n,s},de=function(e,t){var n=typeof t,r="";return"string"==n||"object"==n?r+='"'+e+'":"'+t+'"':"function"==typeof t?r+='"'+e+'":"function '+t.name+'"':"symbol"==typeof t?r+='"'+e+'":"symbol"':"number"!=typeof t&&"boolean"!=n||(r+='"'+e+'": '+t),r},fe=function(e){var t=typeof e;return""+("undefined"==t||"symbol"==t||"function"==t?"null":"string"==t||"object"==t?'"'+e+'"':e)},ve=function(t){var n;return t.payload?(n={},Object.keys(t).forEach(function(e){"payload"!==e&&(n[e]=t[e])}),n):t},ye=/data:(image|text|application|font)\/.*;base64/,we=function(e){return e.filter(function(n,r){return"static"!==n.type||!e.find(function(e,t){return n.url===e.url&&200===n.status&&r<t})})},be=function(e){e.level===X.INFO_ALL&&(e.level=X.INFO)},v={},Ee={},Re=function(e){return v[e]||(v[e]=setTimeout(function(){Ee[e]={},v[e]=null},6e4)),v[e]},Se=function(e){return(Array.isArray(e)?e:[e]).map(function(n){return Object.getOwnPropertyNames(n).reduce(function(e,t){return"ctx"!==t&&(e[t]=n[t]),e},{level:X.INFO,msg:""})})},Te=function(r){return function(e){return r.sendPipeline([function(e,n){return n({url:r.config.url||"",data:j(Se(e)),method:"post",contentType:"application/json",type:m.LOG,log:e,requestConfig:{timeout:5e3},success:function(){var t=r.config.onReport;"function"==typeof t&&e.forEach(function(e){t(e)}),"function"==typeof n&&n([])}})}],m.LOG)(e)}},Oe={generateTraceId:Pe(16),generateSpanId:Pe(8)},xe=Array(32);function Pe(t){return function(){for(var e=0;e<2*t;e++)xe[e]=Math.floor(16*Math.random())+48,58<=xe[e]&&(xe[e]+=39);return String.fromCharCode.apply(null,xe.slice(0,2*t))}}function Le(){return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,function(e){return(e^(16*Math.random()&15)>>e/4).toString(16)})}function Ce(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function ke(e){for(var t,n,r,o="",i=0,a=(e=String(e)).length%3;i<e.length;){if(255<(t=e.charCodeAt(i++))||255<(n=e.charCodeAt(i++))||255<(r=e.charCodeAt(i++)))throw new TypeError("Failed to execute 'btoa': The string to be encoded contains characters outside of the Latin1 range.");o+=s.charAt((t=t<<16|n<<8|r)>>18&63)+s.charAt(t>>12&63)+s.charAt(t>>6&63)+s.charAt(63&t)}return a?o.slice(0,a-3)+"===".substring(a):o}function Ie(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!He.test(e))throw new TypeError("Failed to execute 'atob': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var n,r,o="",i=0;i<e.length;)t=s.indexOf(e.charAt(i++))<<18|s.indexOf(e.charAt(i++))<<12|(n=s.indexOf(e.charAt(i++)))<<6|(r=s.indexOf(e.charAt(i++))),o+=64===n?String.fromCharCode(t>>16&255):64===r?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}function Ae(e){var t,n="";return n="object"==typeof e&&(t=(e=((e,t)=>{for(var n=0;n<t.length;n++){var r=t[n],o=e[r]||"function"==typeof e.get&&e.get(r);if(o)return[r,o]}return["",""]})(e,Object.keys(De)))[0])?De[t](e[1]):n}function Me(n){if(n&&n.reduce&&n.length)return 1===n.length?function(e,t){n[0](e,t||qe)}:n.reduce(function(n,r){return function(e,t){return void 0===t&&(t=qe),n(e,function(e){return null==r?void 0:r(e,t)})}});throw new TypeError("createPipeline need at least one function param")}function Ne(t,n){Object.getOwnPropertyNames(t).forEach(function(e){"function"==typeof t[e]&&"constructor"!==e&&(n?n[e]="sendPipeline"===e?function(){return function(){}}:function(){}:t[e]=function(){})})}function Fe(){return void 0!==window.performance&&"function"==typeof performance.getEntriesByType&&"function"==typeof performance.now}function _e(e){var t;return-1<(null==(t=null==(t=window.PerformanceObserver)?void 0:t.supportedEntryTypes)?void 0:t.indexOf(e))}function t(e){return-1!==Ge.indexOf(e)}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",He=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Ue=(o.prototype.generate=function(e,t,n){if(void 0===t&&(t={}),this.url=e,!this.isUrlIgnored()&&this.isUrlInTraceUrls()&&this.traceType){switch(this.traceType){case"traceparent":this.traceId=this.createTraceparent();break;case"b3":this.traceId=this.createB3();break;case"sw8":this.traceId=this.createSw8(n);break;case"sentry-trace":this.traceId=this.createSentryTrace();break;default:return console.warn("this trace key "+this.traceType+" is not supported"),void(this.traceId="")}return t[this.traceType]&&(this.traceId=t[this.traceType]),{name:this.traceType,value:this.traceId}}},o.prototype.createTraceparent=function(){var e=Oe.generateSpanId();return"00-"+Oe.generateTraceId()+"-"+e+"-0"+this.traceFlag.toString(16)},o.prototype.createB3=function(){var e=Oe.generateSpanId();return Oe.generateTraceId()+"-"+e+"-"+this.traceFlag},o.prototype.createSw8=function(e){var t="function"==typeof btoa?btoa:ke,e=e||{},n=e.host,n=void 0===n?"":n,e=e.pathname,e=void 0===e?"":e,r=Ce(),o=Ce();return"1-"+String(t(o))+"-"+String(t(r))+"-1-"+String(t("aegis"))+"-"+String(t("1.43.47"))+"-"+String(t(encodeURI(e)))+"-"+String(t(n))},o.prototype.createSentryTrace=function(){var e=Le().substring(16);return Le()+"-"+e+"-"+this.traceFlag},o.prototype.isUrlIgnored=function(){if(Array.isArray(this.ignoreUrls)&&0!==this.ignoreUrls.length)for(var e=0,t=this.ignoreUrls;e<t.length;e++){var n=t[e];if(this.urlMatches(this.url,n))return!0}return!1},o.prototype.isUrlInTraceUrls=function(){if(!this.urls)return!0;if(Array.isArray(this.urls)){if(0===this.urls.length)return!1;for(var e=0,t=this.urls;e<t.length;e++){var n=t[e];if(this.urlMatches(this.url,n))return!0}}return!1},o.prototype.urlMatches=function(e,t){return"string"==typeof t?e===t:!!e.match(t)},o),De={sw8:function(e){var t="function"==typeof atob?atob:Ie,e=e.split("-")[1];return e?t(e):""},traceparent:function(e){return e.split("-")[1]},b3:function(e){return e.split("-")[0]},"sentry-trace":function(e){return e.split("-")[0]}},qe=function(){},e=(y.use=function(e){-1===y.installedPlugins.indexOf(e)&&e.aegisPlugin&&y.installedPlugins.push(e)},y.unuse=function(e){e=y.installedPlugins.indexOf(e);-1!==e&&y.installedPlugins.splice(e,1)},y.prototype.init=function(e){var t;this.setConfig(e),this.config=(t=this.config,e=e.hostUrl,t.url=(e="string"!=typeof(e=void 0===e?"https://rumt-zh.com":e)?"https://rumt-zh.com":e)+"/collect",t.offlineUrl=e+"/offline",t.whiteListUrl=e+"/collect/whitelist",t.pvUrl=e+"/collect/pv",t.eventUrl=e+"/collect/events",t.speedUrl=e+"/speed",t.customTimeUrl=e+"/speed/custom",t.performanceUrl=e+"/speed/performance",t.performanceUrlForHippy=e+"/speed/hippyPerformance",t.webVitalsUrl=e+"/speed/webvitals",t.setDataReportUrl=e+"/speed/miniProgramData",t.memoryUrl=e+"/memory",t);for(var n=0;n<y.installedPlugins.length;n++)try{y.installedPlugins[n].patch(this)}catch(e){this.sendSDKError(e)}this.lifeCycle.emit("onInited")},y.prototype.destroy=function(e){void 0===e&&(e=!1);var t,n,r=y.instances.indexOf(this);-1!==r&&y.instances.splice(r,1);for(var o=y.installedPlugins.length-1;0<=o;o--)try{y.installedPlugins[o].unpatch(this)}catch(e){this.sendSDKError(e)}if(this.lifeCycle.emit("destroy"),this.lifeCycle.clear(),e)t=this,n=Object.getOwnPropertyDescriptors(t),Object.keys(n).forEach(function(e){n[e].writable&&(t[e]=null)}),Object.setPrototypeOf(this,null);else{for(var i=this;i.constructor!==Object&&Ne(i,this),i=Object.getPrototypeOf(i););0===y.instances.length&&(r=Object.getPrototypeOf(this).constructor,Ne(r),Ne(y))}},y.prototype.setConfig=function(e){Object.assign(this.config,e);var e=this.config,t=e.id,n=e.uin,r=e.version,o=e.ext1,i=e.ext2,a=e.ext3,s=e.aid,l=e.env,c=void 0===l?"production":l,l=e.pageUrl,e=this.bean.id!==t||this.bean.uin!==n||this.bean.aid!==s;return this.bean.id=t||"",this.bean.uin=n||"",this.bean.version=r||"1.43.47",this.bean.aid=s||"",this.bean.env=(()=>{switch(c){case d.production:case d.development:case d.gray:case d.pre:case d.daily:case d.local:case d.test:case d.others:return 1;default:return}})()?c:d.others,l&&this.extendBean("from",encodeURIComponent(l.slice(0,2048))),o&&this.extendBean("ext1",encodeURIComponent(o)),i&&this.extendBean("ext2",encodeURIComponent(i)),a&&this.extendBean("ext3",encodeURIComponent(a)),e&&this.lifeCycle.emit("onConfigChange",this.config),this.config},y.prototype.extendBean=function(e,t){this.bean[e]=t},y.prototype.send=function(e,o,i){var t=this;return Me([re(this),te(this,null==e?void 0:e.type),function(n,r){t.request(n,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r({isErr:!1,result:e,logType:n.type,logs:n.log}),null!=o&&o.apply(void 0,e)},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r({isErr:!0,result:e,logType:n.type,logs:n.log}),null!=i&&i.apply(void 0,e)})},oe(this)])(e)},y.prototype.sendSDKError=function(e){var n=this;this.sendPipeline([function(e,t){t({url:n.config.url+"?id=1085&msg[0]="+encodeURIComponent(g(e))+"&level[0]=2&from="+n.config.id+"&count=1&version="+n.config.id+"(1.43.47)",addBean:!1,method:"get",type:m.SDK_ERROR,log:e})}],m.SDK_ERROR)(e)},y.prototype.sendPipeline=function(e,t){var n,i=this;return Me(u([function(e,t){if("number"!=typeof n.config.random&&(console.warn("random must in [0, 1], default is 1."),n.config.random=1),!n.isHidden||!n.isGetSample)if(n.isGetSample)n.isHidden||t(e);else{if(n.isGetSample=!0,Math.random()<n.config.random)return n.isHidden=!1,t(e);n.isHidden=!0}},ne(n=this,t)],e,[te(this,t),re(this),function(r,o){i.request(r,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=!1;-1<(""+e[i.failRequestCount=0]).indexOf("403 forbidden")&&(n=!0,i.destroy()),o({isErr:n,result:e,logType:null==r?void 0:r.type,logs:null==r?void 0:r.log}),null!=(n=null==r?void 0:r.success)&&n.call.apply(n,u([r],e))},function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];60<=++i.failRequestCount&&i.destroy(),-1<(""+t[0]).indexOf("403 forbidden")&&i.destroy(),o({isErr:!0,result:t,logType:null==r?void 0:r.type,logs:null==r?void 0:r.log}),null!=(e=null==r?void 0:r.fail)&&e.call.apply(e,u([r],t))})},oe(this)]))},y.prototype.validateRange=function(e){return 0<=e&&e<=127?e:-1},y.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:X.INFO,msg:e,originFrom:this.getOriginFrom()};1===e.length&&e[0].msg&&Object.assign(n,V({},e[0]),{level:X.INFO,originFrom:this.getOriginFrom()}),this.normalLogPipeline(n)},y.prototype.infoAll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:X.INFO_ALL,msg:e,originFrom:this.getOriginFrom()};1===e.length&&e[0].msg&&Object.assign(n,V({},e[0]),{level:X.INFO_ALL,originFrom:this.getOriginFrom()}),this.normalLogPipeline(n)},y.prototype.report=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:X.REPORT,msg:e,originFrom:this.getOriginFrom()};1===e.length&&e[0].msg&&Object.assign(n,V({},e[0]),{originFrom:this.getOriginFrom()}),this.normalLogPipeline(n)},y.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:X.ERROR,msg:e,originFrom:this.getOriginFrom()};1===e.length&&e[0].msg&&Object.assign(n,V({},e[0]),{level:X.ERROR,originFrom:this.getOriginFrom()}),this.normalLogPipeline(n)},y.prototype.reportEvent=function(e){e&&((e="string"==typeof e?{name:e,ext1:this.config.ext1||"",ext2:this.config.ext2||"",ext3:this.config.ext3||"",originFrom:this.getOriginFrom()}:V(V({},e),{originFrom:e.originFrom||this.getOriginFrom()})).name?("string"!=typeof e.name&&(console.warn("reportEvent params name must be string"),e.name=String(e.name)),this.eventPipeline(e)):console.warn("reportEvent params error"))},y.prototype.reportT=function(e){var t=e.name,n=e.duration,r=e.ext1,r=void 0===r?"":r,o=e.ext2,o=void 0===o?"":o,i=e.ext3,i=void 0===i?"":i,a=e.ext4,s=e.ext5,l=e.ext6,c=e.ext7,u=e.ext8,d=e.ext9,f=e.ext10,e=e.from;if("string"==typeof t&&"number"==typeof n&&"string"==typeof r&&"string"==typeof o&&"string"==typeof i){if(!(n<0||2147483646<n))return this.submitCustomTime(t,n,r,o,i,void 0===a?"":a,void 0===s?"":s,void 0===l?"":l,void 0===c?"":c,void 0===u?"":u,void 0===d?"":d,void 0===f?"":f,void 0===e?"":e);console.warn("reportTime: duration must between 0 and 2147483646")}else console.warn("reportTime: params error")},y.prototype.reportTime=function(e,t){if("object"==typeof e)return this.reportT(e);"string"==typeof e?"number"==typeof t?t<0||2147483646<t?console.warn("reportTime: duration must between 0 and 2147483646"):(this.submitCustomTime(e,t),this.normalLogPipeline({level:X.SPEED_EVENT,msg:"key:"+e+"\\n duration:"+t,errorMsg:"",originFrom:this.getOriginFrom()})):console.warn("reportTime: second param must be number"):console.warn("reportTime: first param must be a string")},y.prototype.time=function(e){"string"==typeof e?this.timeMap[e]?console.warn("Timer "+e+" already exists"):this.timeMap[e]=Date.now():console.warn("time: first param must be a string")},y.prototype.timeEnd=function(e){"string"==typeof e?this.timeMap[e]?(this.submitCustomTime(e,Date.now()-this.timeMap[e]),delete this.timeMap[e]):console.warn("Timer "+e+" does not exist"):console.warn("timeEnd: first param must be a string")},y.prototype.ready=function(e,t,n){throw new Error('You need to override "ready" method')},y.prototype.request=function(e,t,n){throw new Error('You need to override "request" method')},y.prototype.speedLogPipeline=function(e){throw new Error('You need to override "speedLogPipeline" method')},y.prototype.getOriginFrom=function(){throw new Error('You need to override "getOriginFrom" method')},Object.defineProperty(y.prototype,"__version__",{get:function(){return"1.43.47"},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"LogType",{get:function(){return X},enumerable:!1,configurable:!0}),y.prototype.reportPv=function(e){e&&console.warn("reportPv is deprecated, please use reportEvent")},y.prototype.submitCustomTime=function(e,t,n,r,o,i,a,s,l,c,u,d,f){e={name:e,duration:t,ext1:String(n||this.config.ext1||"").slice(0,1024),ext2:String(r||this.config.ext2||"").slice(0,1024),ext3:String(o||this.config.ext3||"").slice(0,1024),ext4:i||this.config.ext4,ext5:a||this.config.ext5,ext6:s||this.config.ext6,ext7:l||this.config.ext7,ext8:c||this.config.ext8,ext9:u||this.config.ext9,ext10:d||this.config.ext10,from:f||void 0};this.customTimePipeline(e)},y.version="1.43.47",y.instances=[],y.logType=X,y.environment=d,y.installedPlugins=[],y),n=(r.prototype.patch=function(e){this.canUse(e)&&this.exist(e)&&(this.instances.push(e),this.triggerInit(e),this.triggerOnNewAegis(e))},r.prototype.unpatch=function(e){var t=this.instances.indexOf(e);-1!==t&&(this.instances.splice(t,1),0===this.instances.length)&&this.uninstall(e)},r.prototype.countInstance=function(){return this.instances.length},r.prototype.uninstall=function(e){var t;null!=(t=null==(t=this.option)?void 0:t.destroy)&&t.apply(this,[e])},r.prototype.walk=function(n){var r=this;this.instances.forEach(function(e){var t=r.canUse(e);t&&n(e,t)})},r.prototype.canUse=function(e){e=this.getConfig(e);return!(!e||"object"!=typeof e)||!!e},r.prototype.getConfig=function(e){return null==(e=e.config)?void 0:e[this.name]},r.prototype.exist=function(e){return-1===this.instances.indexOf(e)},r.prototype.triggerInit=function(e){var t;this.inited||(this.inited=!0,null==(t=null==(t=this.option)?void 0:t.init))||t.call(this.option,this.getConfig(e))},r.prototype.triggerOnNewAegis=function(e){var t;null!=(t=null==(t=this.option)?void 0:t.onNewAegis)&&t.call(this.option,e,this.getConfig(e))},r),je=new n({name:"aid",aid:"",init:function(e){try{var t=!0!==e&&e||window.localStorage.getItem("AEGIS_ID");t||(t=Ce(),window.localStorage.setItem("AEGIS_ID",t)),this.aid=t}catch(e){}},onNewAegis:function(e){e.bean.aid=this.aid,e.config.aid=this.aid}}),We=new n({name:"reportAssetSpeed"}),Be=We=new n({name:"reportAssetSpeed",collectCur:0,collectEntryType:"resource",ASSETS_INITIATOR_TYPE:["img","css","script","link","audio","video"],getFromParam:function(e){return e.getCurrentPageUrl()},onNewAegis:function(e){var t=this;Fe()&&(setTimeout(function(){t.collectSuccessLog(e),t.collectFailLog(e)},5e3),performance.onresourcetimingbufferfull=function(){"function"==typeof performance.clearResourceTimings&&(t.collectCur=0,performance.clearResourceTimings())})},processLog:function(e,t){var n=t.duration||0,r=t.transferSize||0,o=!1,i=e.config;if(null!=(s=null==i?void 0:i.api)&&s.isSlowAsset&&"function"==typeof(null==(s=null==i?void 0:i.api)?void 0:s.isSlowAsset))try{o=null==(a=null==i?void 0:i.api)?void 0:a.isSlowAsset(t)}catch(e){return void console.warn("[Aegis] isSlowAsset function happen error:",e,", this data will not be reported.")}else o=null!=(s=null==i?void 0:i.api)&&s.assetSlowThreshold&&"number"==typeof(null==(a=null==i?void 0:i.api)?void 0:a.assetSlowThreshold)?n>(null==(s=null==i?void 0:i.api)?void 0:s.assetSlowThreshold):1e3<n;var a=["ASSET_REQUEST: "+t.url,"status: "+t.status,"duration: "+n+"ms","type: "+t.type,"domainLookup: "+t.domainLookup+"ms","connectTime: "+t.connectTime+"ms","transferSize: "+(0<r?r+"bytes":"unknown")].filter(Boolean).join("\n\n"),i=e.isWhiteList&&e.config.assetLog,s=e.config.slowAssetLog&&o,t={level:o?e.LogType.SLOW_ASSET_REQUEST:e.LogType.ASSERT_REQUEST,msg:a,ext1:n.toString()||"",errorMsg:"",originFrom:e.getOriginFrom()};(i||s)&&e.normalLogPipeline(t)},publish:function(t,n){var r=this;this.$walk(function(e){e===n&&(e.speedLogPipeline(t),Array.isArray(t)?t.forEach(r.processLog):r.processLog(n,t))})},publishMany:function(e,t){for(var n=t.config,r=this.getFromParam(t),o=0,i=e.length;o<i;o++){var a=e[o];-1===this.ASSETS_INITIATOR_TYPE.indexOf(a.initiatorType)||Q(a.name,n.hostUrl)||this.publish(this.generateLog(a,n,r),t)}},collectSuccessLog:function(n){var e,t,r=this;"function"==typeof window.PerformanceObserver?(this.publishMany(performance.getEntriesByType(this.collectEntryType),n),(e=new window.PerformanceObserver(function(e){r.publishMany(e.getEntries(),n)})).observe({entryTypes:[this.collectEntryType]}),n.lifeCycle.on("destroy",function(){0===We.countInstance()&&e.disconnect()})):(t=setInterval(function(){var e=performance.getEntriesByType(r.collectEntryType),t=e.slice(r.collectCur);r.collectCur=e.length,r.publishMany(t,n)},3e3),n.lifeCycle.on("destroy",function(){0===We.countInstance()&&clearInterval(t)}))},collectFailLog:function(o){function e(e){var t,n,r;e&&(e=e.target||e.srcElement,!(t=(null==e?void 0:e.src)||(null==e?void 0:e.href))||"string"!=typeof t||-1<window.location.href.indexOf(t)||(e="function"==typeof(null==(e=a.api)?void 0:e.resourceTypeHandler)?null==(e=a.api)?void 0:e.resourceTypeHandler(t):"",r=performance.getEntriesByType(i.collectEntryType).find(function(e){return e.name===t}),Q(t,a.hostUrl))||(n=i.getFromParam(o),r={url:z(t),status:400,duration:Number(((null==r?void 0:r.duration)||0).toFixed(2)),method:"get",type:e||"static",isHttps:J(t),urlQuery:G(t,!0),nextHopProtocol:"",domainLookup:0,connectTime:0,from:n},i.publish(r,o)))}var i=this,a=o.config;window.document.addEventListener("error",e,!0),o.lifeCycle.on("destroy",function(){0===We.countInstance()&&window.document.removeEventListener("error",e,!0)})},generateLog:function(e,t,n){var t="function"==typeof(null==(r=t.api)?void 0:r.resourceTypeHandler)?null==(r=t.api)?void 0:r.resourceTypeHandler(e.name):"",r=e.transferSize;return{url:z(e.name),method:"get",duration:Number(e.duration.toFixed(2)),status:200,type:t||"static",isHttps:J(e.name),nextHopProtocol:e.nextHopProtocol||"",urlQuery:G(e.name,!0),domainLookup:B(e.domainLookupEnd-e.domainLookupStart),connectTime:B(e.connectEnd-e.connectStart),transferSize:0<r?r:-1,from:n}},collectNotReportedLog:function(e){var t,n;Fe()&&(t=(n=performance.getEntriesByType(this.collectEntryType)).length,"function"!=typeof window.PerformanceObserver)&&this.collectCur!==t&&(n=n.slice(this.collectCur),this.collectCur=t,this.publishMany(n,e))},destroy:function(){this.option.publish=function(){}}}),Ge=window.navigator.userAgent.toLowerCase(),i={};function r(e){this.aegisPlugin=!0,this.name="",this.instances=[],this.inited=!1,e.$walk=this.walk.bind(this),e.$getConfig=this.getConfig.bind(this),this.option=e,this.name=e.name}function y(e){var n,r,o,a,t,s,l,i,c,u,d,f,p,h=this;this.isGetSample=!1,this.isHidden=!1,this.config={version:0,delay:1e3,onError:!0,repeat:60,random:1,aid:!0,device:!0,pagePerformance:!0,webVitals:!0,speedSample:!0,onClose:!0,reportLoadPackageSpeed:!0,hostUrl:"https://rumt-zh.com",env:"production",url:"",offlineUrl:"",whiteListUrl:"",pvUrl:"",speedUrl:"",customTimeUrl:"",performanceUrl:"",performanceUrlForHippy:"",webVitalsUrl:"",eventUrl:"",setDataReportUrl:"",memoryUrl:"",reportImmediately:!0},this.isWhiteList=!1,this.lifeCycle=new q,this.bean={},this.normalLogPipeline=Me([Z(this,5),ee,function(e,t){var r=n.config;t(e=e.map(function(e){var t,n=r.maxLength||10240;try{if(!e.msg||e.msg.length<=n)return e;e.msg=null==(t=e.msg)?void 0:t.substring(0,n)}catch(t){e.msg=g(e.msg).substring(0,r.maxLength)}return e}))},(p=(n=this).config,function(e,t){var n="number"==typeof p.repeat?p.repeat:60;if(n<=0)return t(e);var r=(null==p?void 0:p.id)+"_error",o=Ee[r]||{};t(e.filter(function(e){if(e.level===X.ERROR||e.level===X.PROMISE_ERROR||e.level===X.AJAX_ERROR||e.level===X.SCRIPT_ERROR||e.level===X.IMAGE_ERROR||e.level===X.CSS_ERROR||e.level===X.MEDIA_ERROR||e.level===X.RET_ERROR||e.level===X.BRIDGE_ERROR||e.level===X.PAGE_NOT_FOUND_ERROR||e.level===X.WEBSOCKET_ERROR||e.level===X.LAZY_LOAD_ERROR){e=e.msg.slice(0,200);if(o[e]>n)return v[r]||Re(r),!1;o[e]=1+~~o[e],Ee[r]=o}return!0}))}),(d=this.lifeCycle.emit,f=this.config,function(e,t){var n,r=f.logCreated;return"function"==typeof r?(n=e.filter(function(e){return!1!==r(e)}),d("beforeWrite",n),t(n)):(d("beforeWrite",e),t(e))}),(u=this,setTimeout(function(){var e=u.config,t=e.pvUrl,o=void 0===t?"":t,t=e.spa,e=-1<["web-sdk","mp-sdk"].indexOf("web-sdk");o&&(e&&!t||!e)&&u.sendPipeline([function(e,t){var n=u.getOriginFrom(),r=null!=o&&o.includes("?")?"&":"?";t({url:n?o+r+"originFrom="+encodeURIComponent(n):o,type:m.PV})}],m.PV)(null)},100),function(e,t){t(e)}),(i=l=s=!1,c=[],(a=this).lifeCycle.on("onConfigChange",function(){t&&clearTimeout(t),t=setTimeout(function(){var e,n;!i&&a.config&&(i=!0,e=a.config.whiteListUrl,(n=void 0===e?"":e)&&a.sendPipeline([function(e,t){t({url:n,type:m.WHITE_LIST,success:function(e){l=!0;try{var t=e.data||JSON.parse(e),n=t.retcode,r=t.result,o=void 0===r?{}:r,i=(0===n&&(s=o.is_in_white_list,a.isWhiteList=s,0<=o.rate)&&o.rate<=1&&(a.config.random=o.rate,a.isGetSample=!1),a.isWhiteList&&c.length?Te(a)(c.splice(0),function(){}):!a.isWhiteList&&c.length&&(c.length=0),a.config.onWhitelist);"function"==typeof i&&i(s)}catch(e){}},fail:function(){l=!0}})}],m.WHITE_LIST)(null),i=!1)},a.config.uin?50:500)}),a.lifeCycle.on("destroy",function(){c.length=0}),function(e,t){var n;s||null!=(n=null==(n=a.config)?void 0:n.api)&&n.reportRequest?t(e.concat(c.splice(0)).map(function(e){return be(e),e})):(n=e.filter(function(e){return e.level!==X.INFO&&e.level!==X.API_RESPONSE?(be(e),!0):(l||(c.push(e),200<=c.length&&(c.length=200)),!1)})).length&&t(n)}),function(e,t){try{var n=e.filter(function(e){return[X.ERROR,X.PROMISE_ERROR,X.AJAX_ERROR,X.SCRIPT_ERROR,X.IMAGE_ERROR,X.CSS_ERROR,X.MEDIA_ERROR,X.WEBSOCKET_ERROR,X.BRIDGE_ERROR,X.BLANK_SCREEN,X.RET_ERROR,X.PAGE_NOT_FOUND_ERROR,X.LAZY_LOAD_ERROR].includes(e.level)}),r=(n.length&&h.lifeCycle.emit("errorOccurred",n),e.forEach(function(t){["ext1","ext2","ext3"].forEach(function(e){t[e]&&"string"==typeof t[e]&&(t[e]=t[e].slice(0,1024))}),["ext4","ext5","ext6","ext7","ext8","ext9","ext10"].forEach(function(e){t[e]&&"string"!=typeof t[e]&&(t[e]=String(t[e]))})}),JSON.parse(JSON.stringify(e))),o=(h.lifeCycle.emit("beforeReport",r),h.config.beforeReport);(e="function"==typeof o?e.filter(function(e){return!1!==o(e)}):e).length&&t(e)}catch(e){}},Te(this)]),this.eventPipeline=Me([Z(this,10),(o=this,function(e){o.sendPipeline([function(e,t){var n=e.map(function(e){return{name:e.name,originFrom:e.originFrom,ext1:String(e.ext1||o.config.ext1||"").slice(0,1024),ext2:String(e.ext2||o.config.ext2||"").slice(0,1024),ext3:String(e.ext3||o.config.ext3||"").slice(0,1024),ext4:String(e.ext4||o.config.ext4||""),ext5:String(e.ext5||o.config.ext5||""),ext6:String(e.ext6||o.config.ext6||""),ext7:String(e.ext7||o.config.ext7||""),ext8:String(e.ext8||o.config.ext8||""),ext9:String(e.ext9||o.config.ext9||""),ext10:String(e.ext10||o.config.ext10||"")}});t({url:o.config.eventUrl+"?payload="+encodeURIComponent(JSON.stringify(n)),type:m.EVENT,log:e})}],m.EVENT)(e)})]),this.customTimePipeline=Me([Z(this,10),(r=this,function(e){return r.sendPipeline([function(e,t){t({url:r.config.customTimeUrl+"?payload="+encodeURIComponent(JSON.stringify({custom:e})),type:m.CUSTOM,log:e})}],m.CUSTOM)(e)})]),this.timeMap={},this.failRequestCount=0,y.instances.push(this)}function o(e,t,n,r){void 0===n&&(n=null),this.traceType=e,this.ignoreUrls=t,this.urls=n,this.traceFlag=null==r?1:Number(!!r)}i.macos=function(){return t("mac")},i.ios=function(){return i.iphone()||i.ipod()||i.ipad()},i.iphone=function(){return!i.windows()&&t("iphone")},i.ipod=function(){return t("ipod")},i.ipad=function(){var e="MacIntel"===navigator.platform&&1<navigator.maxTouchPoints;return t("ipad")||e},i.android=function(){return!i.windows()&&t("android")},i.androidPhone=function(){return i.android()&&t("mobile")},i.androidTablet=function(){return i.android()&&!t("mobile")},i.blackberry=function(){return t("blackberry")||t("bb10")},i.blackberryPhone=function(){return i.blackberry()&&!t("tablet")},i.blackberryTablet=function(){return i.blackberry()&&t("tablet")},i.windows=function(){return t("windows")},i.windowsPhone=function(){return i.windows()&&t("phone")},i.windowsTablet=function(){return i.windows()&&t("touch")&&!i.windowsPhone()},i.fxos=function(){return(t("(mobile")||t("(tablet"))&&t(" rv:")},i.fxosPhone=function(){return i.fxos()&&t("mobile")},i.fxosTablet=function(){return i.fxos()&&t("tablet")},i.meego=function(){return t("meego")},i.cordova=function(){return window.cordova&&"file:"===location.protocol},i.nodeWebkit=function(){return"object"==typeof window.process},i.mobile=function(){return i.androidPhone()||i.iphone()||i.ipod()||i.windowsPhone()||i.blackberryPhone()||i.fxosPhone()||i.meego()},i.tablet=function(){return i.ipad()||i.androidTablet()||i.blackberryTablet()||i.windowsTablet()||i.fxosTablet()},i.desktop=function(){return!i.tablet()&&!i.mobile()};function ze(){return{host:new URL(location.href).host,pathname:location.pathname}}function Je(r,e,o){return null!=e&&e.length&&"object"==typeof r?e.reduce(function(e,t){var n=window.Headers&&r instanceof Headers?r.get(t):r[t];return n?e+(""===e?"":"\n\n")+o+" header "+t+": "+n:e},""):""}function Ve(e,t){return e&&-1===["null","undefined"].indexOf(e)?t+": "+e:""}function Xe(e,t,n){void 0===t&&(t="");var r,o,e="function"==typeof(null==(o=e.api)?void 0:o.resourceTypeHandler)?null==(o=e.api)?void 0:o.resourceTypeHandler(n):"";return-1===U.indexOf(e)&&(r=void 0===t?"":t,o=(void 0===n?"":n).split("?")[0],e=ae.test(o)||ie.some(function(e){return-1!==String(r).indexOf(e)})?"static":"fetch"),e}function $e(e,t){return e?X.AJAX_ERROR:t?X.RET_ERROR:X.API_RESPONSE}function Ke(e,t,n){var r,o;if(!e)return!1;if(null!=(r=null==t?void 0:t.api)&&r.isSlowApi&&"function"==typeof(null==(r=null==t?void 0:t.api)?void 0:r.isSlowApi))try{return null==(o=null==t?void 0:t.api)?void 0:o.isSlowApi(n||{duration:e})}catch(e){return console.warn("[Aegis] isSlowApi function happen error:",e,", this data will not be reported."),!1}return null!=(r=null==t?void 0:t.api)&&r.apiSlowThreshold&&"number"==typeof(null==(o=null==t?void 0:t.api)?void 0:o.apiSlowThreshold)?e>(null==(n=null==t?void 0:t.api)?void 0:n.apiSlowThreshold):1e3<e}function Ye(e,t){if(null!=(e=e.api)&&e.usePerformanceTiming&&"string"==typeof t.url){e=null==(e=performance.getEntriesByName(t.url))?void 0:e.pop();if(e)return{url:t.url,isHttps:J(t.url),method:t.method,type:t.type,status:t.status,duration:Number(e.duration.toFixed(2)),nextHopProtocol:e.nextHopProtocol||"",domainLookup:B(e.domainLookupEnd-e.domainLookupStart),connectTime:B(e.connectEnd-e.connectStart)}}return{url:t.url,isHttps:J(t.url),method:t.method,type:t.type,status:t.status,duration:Number(t.duration.toFixed(2)),nextHopProtocol:"",domainLookup:D.number,connectTime:D.number}}function Qe(){return window.location.href}function Ze(e){return(e=(e=>{var t="",n=e.nodeType;if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(var r=e.firstChild;r;r=r.nextSibling)t+=It(e)}else if(3===n||4===n)return e.nodeValue;return t})(e))?e.replace(/^\s+|\s+$/g,""):""}var et,tt,nt,rt,a,ot,it,l,at,st,lt,ct,ut,dt,ft,pt,ht,mt,gt=!(i.isIE=function(){return"ActiveXObject"in window}),c=[],vt=/^\/[^/]/,yt=!1,h=[],wt={maxRetryCount:10,retryInterval:function(e){return 1e3*(2<<e)},whenRetryEndStillFail:"discard"},bt=(new n({name:"reportApiSpeed"}),new n({name:"reportApiSpeed",override:!1,onNewAegis:function(e){var t,n;this.override||(this.override=!0,null!=(n=e.config.api)&&n.injectTraceHeader&&(this.traceRequestHeader=new Ue(n.injectTraceHeader,null!=(t=null==n?void 0:n.injectTraceIgnoreUrls)?t:[],null==n?void 0:n.injectTraceUrls,null==n?void 0:n.traceFlag)),this.overrideFetch(e.config,e),this.overrideXhr(e.config,e))},getFromParam:function(e){return e.getCurrentPageUrl()},overrideFetch:function(b,E){var R=this,e=b.api,e={name:this.name,traceRequestHeader:null!=e&&e.injectTraceHeader?this.traceRequestHeader:null,getCurrentFrom:function(){return R.getFromParam(E)},then:function(f,p,h,m,g,v,y){var e,w;Q(h,b.hostUrl)||(e=f.headers?f.headers.get("content-type"):"","fetch"===(w=Xe(b,e||"",h))?f.clone().text().then(function(r){var e,o=f.status<=0||400<=f.status,t=(null==(t=b.api)?void 0:t.reqHeaders)||[],i=Je(null==m?void 0:m.headers,t,"req"),t=(null==(t=b.api)?void 0:t.resHeaders)||[],a=Je(f.headers,t,"res"),s=Ae(null==m?void 0:m.headers),t=$(r,b.api,{url:h,ctx:f,payload:null==m?void 0:m.body}),l=t.code,c=t.isErr,t=null==(t=b.api)?void 0:t.apiDetail,u=t?K(null==m?void 0:m.body,null==(e=b.api)?void 0:e.reqParamHandler,{url:h}):"",d=t?K(r,null==(e=b.api)?void 0:e.resBodyHandler,{url:h,ctx:f}):"";setTimeout(function(){var e=Ye(b,{url:h,duration:p,type:w,status:f.status||0,method:(null==m?void 0:m.method)||"get"}),t=[o?"FETCH_ERROR: "+r:"","fetch req url: "+h,"res status: "+(e.status||0),"res duration: "+e.duration+"ms","res startTime: "+g,i,a,"req method: "+(e.method||"GET"),"res retcode: "+l,Ve(u,"req param"),Ve(d,"res data")].filter(function(e){return e}).join("\n\n"),t=(e.payload=null==m?void 0:m.body,e.ret=l,e.isErr=+c,e.from=v||R.getFromParam(E),{msg:t,code:l,trace:s,errorMsg:"",from:v||R.getFromParam(E),originFrom:y,level:X.API_RESPONSE}),n=b.slowApiLog&&Ke(null==e?void 0:e.duration,b,e);t.level=n?X.SLOW_NET_REQUEST:$e(o,c),(n||t.level!==X.API_RESPONSE||E.isWhiteList||null!=(n=null==(n=E.config)?void 0:n.api)&&n.reportRequest)&&R.publishNormalLog(t,E),R.publishSpeed(e,E)},0)}).catch(function(e){console.info("ignore something error when process resp "+e)}):setTimeout(function(){var e=Ye(b,{url:h,duration:p,type:w,status:f.status||0,method:(null==m?void 0:m.method)||"get"});e.type="static",e.urlQuery=G(h,!0),e.from=v||R.getFromParam(E),R.publishSpeed(e,E)},0))},catch:function(t,n,r,o,i,a,s){var l,e,c,u,d;throw Q(r,b.hostUrl)||(l=Xe(b,"",r),e=(null==(e=b.api)?void 0:e.reqHeaders)||[],c=Je(null==o?void 0:o.headers,e,"req"),u=Ae(null==o?void 0:o.headers),d=null!=(e=b.api)&&e.apiDetail?K(null==o?void 0:o.body,null==(e=b.api)?void 0:e.reqParamHandler,{url:r}):"",setTimeout(function(){var e=Ye(b,{url:r,duration:n,type:l,status:0,method:(null==o?void 0:o.method)||"get"}),e=(e.from=a||R.getFromParam(E),R.publishSpeed(e,E),"AJAX_ERROR: "+t+"\n                          \nreq url: "+r+"\n                          \nres status: 0\n                          \nres duration: "+e.duration+"ms\n                          \nreq method: "+((null==o?void 0:o.method)||"get")+"\n                          \nreq param: "+d+"\n                          \nres startTime: "+i+"\n                          \n"+c);R.publishNormalLog({msg:e,level:X.AJAX_ERROR,code:-400,trace:u,errorMsg:"",from:a||R.getFromParam(E),originFrom:s},E)},0)),t}},f=(this.hackFetchOptions=e,this.hackFetchOptions),p=null==(e=b.api)?void 0:e.ignoreHackReg;if(void 0===p&&(p=/\.flv(\?|$)/i),h.find(function(e){return e.name===f.name}))throw new Error("name '"+f.name+"' is already in hackFetch option list");h.push(f),!yt&&window.fetch&&(yt=!0,rt=window.fetch,window.fetch=function(e,o){void 0===o&&(o={});var i="string"==typeof e?e:null==e?void 0:e.url;if(null!=(a=null==p?void 0:p.test)&&a.call(p,i))return rt(i,o);vt.test(i)&&(i=""+location.origin+i);var t,n,r,a=(f||{}).traceRequestHeader;a&&(t=void 0===(t=(o||{}).headers)?{}:t,n=(r=ze()).host,n=(a=a.generate(i,t,{host:n,pathname:r.pathname})||{}).name,r=a.value)&&n&&(o.headers=Object.assign(t,((a={})[n]=r,a)));for(var s=new Map,l=window.location.href,c=0;c<h.length;c++){var u=h[c];try{"function"==typeof u.beforeFetch&&u.beforeFetch(i,o),"function"==typeof u.getCurrentFrom&&s.set(u.name,u.getCurrentFrom())}catch(e){}}var d=Date.now();return rt(e,o).then(function(e){for(var t=e.clone(),n=0;n<h.length;n++){var r=h[n];try{"function"==typeof r.then&&r.then(t,Date.now()-d,i,o,d,s.get(r.name),l)}catch(e){}}return t}).catch(function(e){for(var t=0;t<h.length;t++){var n=h[t];try{"function"==typeof n.catch&&n.catch(e,Date.now()-d,i,o,d,s.get(n.name),l)}catch(e){}}throw e})})},overrideXhr:function(b,E){var o,R=this,e={name:this.name,ignoreHackReg:null==(e=b.api)?void 0:e.ignoreHackReg,traceRequestHeader:null!=(e=b.api)&&e.injectTraceHeader?this.traceRequestHeader:null,getCurrentFrom:function(){return R.getFromParam(E)},send:function(f,p,h,m){var e,t,g=Date.now(),v=(((null==b?void 0:b.api)||{}).injectTraceHeader&&(t=(e=ze()).host,e=(t=R.traceRequestHeader.generate(f.aegisUrl,{},{host:t,pathname:e.pathname})||{}).name,t=t.value,e)&&t&&f.setRequestHeader(e,t),f.addEventListener("loadend",function(){var c,n,e,u,d=f.aegisUrl||"";Q(d,b.hostUrl)||"abort"===f.failType||(c="",(f.failType||!f.status||400<=f.status)&&(c=f.failType||"failed"),n=Date.now()-g,e=f.getResponseHeader("content-type")||"",u=Xe(b,e,d),setTimeout(function(){var r=Ye(b,{url:d,duration:n,type:u,status:f.status,method:f.aegisMethod||"get"});if(r.from=h||R.getFromParam(E),"fetch"===u){var e=(null==(e=b.api)?void 0:e.reqHeaders)||[],o=Je(f.aegisXhrReqHeader,e,"req"),e=(null==(e=b.api)?void 0:e.resHeaders)||[],t=f.getAllResponseHeaders().split("\r\n").reduce(function(e,t){t=t.split(": ");return t[0]&&t[1]&&(e[t[0]]=t[1]),e},{}),i=Je(t,e,"res"),a=Ae(f.aegisXhrReqHeader),e=null==(t=b.api)?void 0:t.apiDetail,s=e?K(p,null==(t=b.api)?void 0:t.reqParamHandler,{url:d}):"",l=e?K(f.response,null==(t=b.api)?void 0:t.resBodyHandler,{url:d}):"";try{((e,t,n,r)=>{var o,i,a;try{if("function"==typeof(null==t?void 0:t.retCodeHandlerAsync))return t.retCodeHandlerAsync(e,null==n?void 0:n.url,null==n?void 0:n.ctx,function(e){var t=e.code;null!=r&&r({code:void 0===t?S:t,isErr:e.isErr})});if("function"==typeof(null==t?void 0:t.retCodeHandler))return a=(i=t.retCodeHandler(e,null==n?void 0:n.url,null==n?void 0:n.ctx,null==n?void 0:n.payload)||{}).code,null!=r&&r({code:void 0===a?S:a,isErr:i.isErr});if(!(e="string"==typeof e?JSON.parse(e):e))return null!=r&&r({code:S,isErr:!1});"function"==typeof(null==(o=null==t?void 0:t.ret)?void 0:o.join)&&(se=[].concat(t.ret.map(function(e){return e.toLowerCase()})));var s=Object.getOwnPropertyNames(e).filter(function(e){return-1!==se.indexOf(e.toLowerCase())});if(s.length)return"未知"!==(a=e[s[0]])&&""!==a||(a=S),null!=r&&r({code:""+a,isErr:0!==a&&"0"!==a&&a!==S});null!=r&&r({code:S,isErr:!1})}catch(e){null!=r&&r({code:S,isErr:!1})}})(f.response,b.api,{url:d,ctx:f,payload:p},function(e){var t=e.code,e=e.isErr,n=[c?"AJAX_ERROR: request "+c:"","fetch req url: "+d,"res status: "+(r.status||0),"res duration: "+r.duration+"ms","res startTime: "+g,o,i,"req method: "+(r.method||"GET"),"res retcode: "+t,Ve(s,"req param"),Ve(l,"res data")].filter(function(e){return e}).join("\n\n");r.ret=t,r.isErr=+e,r.payload=p,b.slowApiLog&&Ke(null==r?void 0:r.duration,b,r)?R.publishNormalLog({msg:n,level:X.SLOW_NET_REQUEST,code:t,trace:a,errorMsg:"",from:h||R.getFromParam(E),originFrom:m},E):R.publishNormalLog({msg:n,level:$e(!!c,e),code:t,trace:a,errorMsg:"",from:h||R.getFromParam(E),originFrom:m},E),R.publishSpeed(r,E)})}catch(e){r.ret=S,R.publishSpeed(r,E)}}else r.type="static",r.urlQuery=G(d,!0),R.publishSpeed(r,E);f.removeEventListener("abort",v),f.removeEventListener("error",y),f.removeEventListener("timeout",w)},0))}),function(){f.failType="abort"}),y=function(){f.failType="error"},w=function(){f.failType="timeout"};f.addEventListener("abort",v),f.addEventListener("error",y),f.addEventListener("timeout",w)}};this.hackXHROptions=e,o=this.hackXHROptions,c.find(function(e){return e.name===o.name})||(c.push(o),!gt&&window.XMLHttpRequest&&(et=window.XMLHttpRequest.prototype.send,tt=window.XMLHttpRequest.prototype.open,nt=window.XMLHttpRequest.prototype.setRequestHeader,gt=!0,window.XMLHttpRequest.prototype.open=function(){this.aegisMethod=arguments[0];var e,t=arguments[1];if(vt.test(t)&&(t=""+location.origin+t),this.aegisUrl=t,null==(t=null==(e=o.ignoreHackReg)?void 0:e.test)||!t.call(e,this.aegisUrl))if(this.aegisXhrStartTime=Date.now(),this.sendByAegis)i.isIE()||(this.timeout=5e3);else for(var n=0;n<c.length;n++){var r=c[n];try{"function"==typeof r.open&&r.open(this)}catch(e){}}return tt.apply(this,arguments)},window.XMLHttpRequest.prototype.setRequestHeader=function(){var e,t,n;return null!=(t=null==(n=o.ignoreHackReg)?void 0:n.test)&&t.call(n,this.aegisUrl)?nt.apply(this,arguments):(t=arguments[0],n=arguments[1],this.aegisXhrReqHeader=null!=(e=this.aegisXhrReqHeader)?e:{},null!=o&&o.traceRequestHeader&&-1<["traceparent","b3","sw8","sentry-trace"].indexOf(t)&&(this.aegisXhrReqHeader[t]||(arguments[1]=n),this.aegisXhrReqHeader[t])?void 0:(this.aegisXhrReqHeader[t]=arguments[1],nt.apply(this,arguments)))},window.XMLHttpRequest.prototype.send=function(){var e,t;if(!(null!=(t=null==(e=o.ignoreHackReg)?void 0:e.test)&&t.call(e,this.aegisUrl)||this.sendByAegis))for(var n=0;n<c.length;n++){var r=c[n];try{"function"==typeof r.send&&r.send(this,arguments[0],"function"==typeof r.getCurrentFrom?r.getCurrentFrom():void 0,window.location.href)}catch(e){}}return et.apply(this,arguments)}))},publishSpeed:function(n){var r=this;this.$walk(function(e){var t=r.$getConfig(e);"fetch"!==n.type||"function"!=typeof(null==t?void 0:t.urlHandler)?(n.url=G(n.url),e.speedLogPipeline(n)):e.speedLogPipeline(V(V({},n),{url:G(t.urlHandler(n.url,n.payload))}))})},publishNormalLog:function(t){this.$walk(function(e){e.normalLogPipeline(t)})},destroy:function(){var t,n,e;this.option.publishSpeed=function(){},this.option.publishNormalLog=function(){},this.option.hackXHROptions&&(t=this.option.hackXHROptions,-1!==(e=c.findIndex(function(e){return e.name===t.name})))&&c.splice(e,1),this.option.hackFetchOptions&&(n=this.option.hackFetchOptions,-1!==(e=h.findIndex(function(e){return e.name===n.name})))&&h.splice(e,1),this.option.override=!1}})),Et={},Rt=new n({name:"reportBridgeSpeed",override:!1,onNewAegis:function(e){this.override||(this.override=!0,this.overrideBridge(e))},getFromParam:function(e){return e.getCurrentPageUrl()},publishSpeed:function(t,n){this.$walk(function(e){e===n&&e.speedLogPipeline(t)})},overrideBridge:function(c){var u=this,d=c.config;d.reportBridgeSpeed&&d.h5Bridge&&d.h5BridgeFunc.length&&d.h5BridgeFunc.forEach(function(e){var l=d.h5Bridge[e];Et[e]=l,d.h5Bridge[e]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],o=e[1],n=e[2],i=e[3],a=Date.now(),s=u.getFromParam(c);l(r,o,n,function(e){var t=$(e,d.api),n=t.code,t=t.isErr,n={url:r+"-"+o,name:r+"-"+o,duration:Date.now()-a,type:"bridge",ret:n,isErr:+t,from:s};u.publishSpeed(n,c),i(e)})}})},unHackBridge:function(t){Object.keys(Et).forEach(function(e){Et[e]&&(t.config.h5Bridge[e]=Et[e])}),Et={}},destroy:function(e){this.option.publishSpeed=function(){},this.option.unHackBridge(e),this.option.override=!1}}),f=((f=a=a||{})[f.unknown=100]="unknown",f[f.wifi=1]="wifi",f[f.net2g=2]="net2g",f[f.net3g=3]="net3g",f[f.net4g=4]="net4g",f[f.net5g=5]="net5g",f[f.net6g=6]="net6g",(f=ot=ot||{})[f.android=1]="android",f[f.ios=2]="ios",f[f.windows=3]="windows",f[f.macos=4]="macos",f[f.linux=5]="linux",f[f.other=100]="other",(f=it=it||{})[f.unknown=100]="unknown",f[f.normal=0]="normal",f[f.weak=1]="weak",f[f.disconnected=2]="disconnected",new n({name:"device",onNewAegis:function(e){e.extendBean("platform",this.getPlatform()),e.extendBean("netType",a.unknown),this.getDpi(e),this.refreshNetworkTypeToBean(e),this.refreshNetworkStatusToBean(e)},getDpi:function(e){e.extendBean("vp",Math.round(window.innerWidth)+" * "+Math.round(window.innerHeight)),window.screen&&e.extendBean("sr",Math.round(window.screen.width)+" * "+Math.round(window.screen.height))},getPlatform:function(){var t={android:/\bAndroid\s*([^;]+)/,ios:/\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,windows:/\b(Windows NT)/,macos:/\b(Mac OS)/,linux:/\b(Linux)/i},e=Object.keys(t).find(function(e){return t[e].test(navigator.userAgent)});return e?ot[e]:ot.other},refreshNetworkTypeToBean:function(t){var n=this,e=t.config;e&&("function"==typeof e.getNetworkType?e.getNetworkType:St)(function(e){a[e]||(e=a.unknown),t.extendBean("netType",e),n.NetworkRefreshTimer=setTimeout(function(){n.refreshNetworkTypeToBean(t),clearTimeout(n.NetworkRefreshTimer)},1e4)})},refreshNetworkStatusToBean:function(t){var e,n=this,r=t.config;r&&null!=(e="function"==typeof r.getNetworkStatus?r.getNetworkStatus:e)&&e(function(e){void 0===it[e]&&(e=it.unknown),t.extendBean("netStatus",e),n.NetworkStatusRefreshTimer=setTimeout(function(){n.refreshNetworkStatusToBean(t),clearTimeout(n.NetworkStatusRefreshTimer)},1e4)})}})),St=function(e){var t="",n=navigator.userAgent.match(/NetType\/(\w+)/);n?t=n[1]:navigator.connection&&(t=navigator.connection.effectiveType||navigator.connection.type),e((n=t=t||S,0<=(n=String(n).toLowerCase()).indexOf("4g")?a.net4g:0<=n.indexOf("wifi")?a.wifi:0<=n.indexOf("5g")?a.net5g:0<=n.indexOf("6g")?a.net6g:0<=n.indexOf("3g")?a.net3g:0<=n.indexOf("2g")?a.net2g:a.unknown))},Tt=window.WebSocket,p=[],Ot={construct:function(e,t){var r=new e(t[0],t[1]);return r.originSend=r.send,r.addEventListener("error",function(e){var e=(null==e?void 0:e.currentTarget)||{},t=e.url,n=e.readyState;null!=p&&p.forEach(function(e){e=e.onErr;null!=e&&e({msg:"无法获知具体错误信息，需在浏览器控制台查看！",readyState:n,connectUrl:t})})}),Object.defineProperty(r,"send",{get:function(){return function(e){null!=(t=r.originSend)&&t.call(r,e);var t=r.readyState;if(t!==WebSocket.OPEN){var n={readyState:t,connectUrl:r.url};switch(t){case WebSocket.CLOSED:p.forEach(function(e){e=e.sendErr;null!=e&&e(V({msg:"消息发送失败，连接已关闭！"},n))});break;case WebSocket.CONNECTING:p.forEach(function(e){(0,e.sendErr)(V({msg:"消息发送失败，正在连接中！"},n))});break;case WebSocket.CLOSING:p.forEach(function(e){(0,e.sendErr)(V({msg:"消息发送失败，连接正在关闭！"},n))})}}}}}),r}},xt=new n({name:"onError"}),Pt=xt=new n({name:"onError",onNewAegis:function(e){this.startListen(e)},getFromParam:function(e){return e.getCurrentPageUrl()},startListen:function(a){function e(e){var t,n=e&&g(e.reason);n&&s.publishErrorLog({msg:"PROMISE_ERROR: "+n,errorMsg:null==(t=null==(e=(null==(t=e.reason)?void 0:t.message)||(null==(t=e.reason)?void 0:t.errMsg)||n)?void 0:e.slice)?void 0:t.call(e,0,150),level:X.PROMISE_ERROR,from:s.getFromParam(a),originFrom:a.getOriginFrom()},a)}function t(e){var t;if(e=(null==e?void 0:e.target)||(null==e?void 0:e.srcElement)){var n=e.src||e.href||"",r=e.tagName,r=(void 0===r?"script":r).toLowerCase(),o=["audio","video"].includes(r);if(!o||null!=e&&e.error){if(!(Q(t=n,a.config.hostUrl)||-1<window.location.href.indexOf(t))){var i={msg:r+" load fail: "+n+" "+(o?"\n\nerror code: "+(null==(t=null==e?void 0:e.error)?void 0:t.code)+(""!==(null==(o=null==e?void 0:e.error)?void 0:o.message)?"\nerror msg: "+(null==(t=null==e?void 0:e.error)?void 0:t.message):""):""),level:X.INFO,from:s.getFromParam(a),originFrom:a.getOriginFrom()};if(/\.js$/.test(n))i.level=X.SCRIPT_ERROR;else if(/\.css$/.test(n))i.level=X.CSS_ERROR;else switch(r){case"script":i.level=X.SCRIPT_ERROR;break;case"link":i.level=X.CSS_ERROR;break;case"img":i.level=X.IMAGE_ERROR;break;case"audio":case"video":i.level=X.MEDIA_ERROR;break;default:return}s.publishErrorLog(i,a)}}else console.log("may be media load success because error is undefine")}}var n,r,o,i,s=this,l=window.onerror;window.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r=g(e[0]);"string"!=typeof(n=r)||!n||_.some(function(e){return-1<n.indexOf(e)})||F.some(function(e){return-1<n.indexOf(e)})||s.publishErrorLog({msg:(r||"")+" @ ("+(g(e[1])||"")+":"+(e[2]||0)+":"+(e[3]||0)+")\n          \n"+g(e[4]||""),level:X.ERROR,from:s.getFromParam(a),originFrom:a.getOriginFrom()},a),null!=l&&l.call.apply(l,u([window],e))},window.addEventListener("unhandledrejection",e);window.document.addEventListener("error",t,!0),a.lifeCycle.on("destroy",function(){0===xt.countInstance()&&(window.document.removeEventListener("unhandledrejection",e),window.document.removeEventListener("error",t,!0))}),a.config.websocketHack&&(n={key:a.config.id+"-"+this.name,onErr:function(e){var t;null!=(t=s.publishWsErrorLog)&&t.call(s,e,a)},sendErr:function(e){var t;null!=(t=s.publishWsErrorLog)&&t.call(s,e,a)}},this.hackWebsocketConfig=n,n=this.hackWebsocketConfig,window.Proxy)&&window.WebSocket&&(r=window.WebSocket,window&&!r.isHack&&(o=new Proxy(WebSocket,Ot),r.isHack=!0,window.WebSocket=o),i=n,p.find(function(e){return e.key===i.key})||i&&p.push(i))},publishErrorLog:function(t,n){this.$walk(function(e){e===n&&e.normalLogPipeline(t)})},publishWsErrorLog:function(e,t){var n=e.connectUrl;this.publishErrorLog({msg:"WEBSOCKET_ERROR: \n              connect: "+n+"\n              readyState: "+e.readyState+"\n              msg: "+e.msg,level:X.WEBSOCKET_ERROR,from:this.getFromParam(t),originFrom:t.getOriginFrom()},t)},destroy:function(){var t,e;this.option.publishErrorLog=function(){},this.option.hackWebsocketConfig&&(t=this.option.hackWebsocketConfig,window.WebSocket=Tt,-1!==(e=p.findIndex(function(e){return e.key===t.key})))&&p.splice(e,1)}}),Lt=(new n({name:"clickElementLog"}),function(e){if(""!==e.id&&e.id)return'id("'+e.id+'")';if(e===document.body)return e.tagName;if(e instanceof Document)return"document";var t=0;if(e.parentNode)for(var n=e.parentNode.childNodes,r=0;r<n.length;r+=1){var o=n[r];if(o===e)return Lt(e.parentNode)+"/"+e.tagName+"["+(t+1)+"]";1===o.nodeType&&o.tagName===e.tagName&&(t+=1)}return 0}),Ct=function(e){return e instanceof Array?new Map(e.map(function(e){return[e,!0]})):new Map},kt=function(e,t){return"string"==typeof e?e.split(t):[]},It=function(e){if(3===e.nodeType||4===e.nodeType)return e.nodeValue||"";if(1!==e.nodeType)return"";if("string"==typeof e.textContent)return e.textContent;for(var t="",n=e.firstChild;n;n=n.nextSibling)t+=It(n);return t},At=new n({name:"clickElementLog",listeners:[],onNewAegis:function(e){this.startListen(e)},startListen:function(a){for(var e=function(i){t.listeners.push(((e,t,n,r)=>{function o(e){var t=document.documentElement;t&&n.call(t,e,e.target)}return void 0===r&&(r=!0),e.addEventListener(t,o,r),{destroy:function(){e.removeEventListener(t,o,r)}}})(document,i,function(e,t){var n,r,o;t&&!((e,t)=>{n=Ct((null==(n=(e=e).ignoreElements)?void 0:n.ignoreClasses)||[])||new Map;for(var n,r=(e={ignoreIds:Ct((null==(e=e.ignoreElements)?void 0:e.ignoreIds)||[])||new Map,ignoreClasses:n}).ignoreClasses,o=e.ignoreIds,i=!(0===o.size&&0===r.size),a=t,s=(kt(t.getAttribute("id")||""," "),kt(t.getAttribute("class")||"",""),0),l=!1;a&&i&&a.getAttribute;){if(l)return!0;if(10<=s)break;for(var c=kt(a.getAttribute("id")||""," "),u=kt(a.getAttribute("class")||"",""),d=0,f=c;d<f.length;d++){var p=f[d];if(o.has(p)){l=!0;break}}for(var h=0,m=u;h<m.length;h++){var g=m[h];if(r.has(g)){l=!0;break}}s+=1,a=a.parentNode||a.parentElement}return!1})(a.config,t)&&(n=Lt(t),r=Ze(t),o=t.getBoundingClientRect&&t.getBoundingClientRect(),t={op:i,view_type:(null==t?void 0:t.nodeName)||"",view_text:r.slice(0,127),view_tag:n,page:Qe(),page_id:Qe(),view_pos:{p0:(parseInt(String(o.left),10)||-1)+","+(parseInt(String(o.top),10)||-1),p1:(parseInt(String(o.left+window.scrollX),10)||-1)+","+(parseInt(String(o.top+window.scrollY),10)||-1)}},a.normalLogPipeline({msg:t,level:X.CLICK_EVENT,errorMsg:"",originFrom:a.getOriginFrom()}))},!0))},t=this,n=0,r=Object.entries({click:1,longpress:2});n<r.length;n++)e(r[n][0])},destroy:function(){this.listeners.forEach(function(e){return e.destroy()}),this.listeners=[]}}),Mt=(new n({name:"consoleLog"}),{log:console.log,error:console.error,warn:console.warn,info:console.info,debug:console.debug,trace:console.trace}),Nt=new n({name:"consoleLog",onNewAegis:function(e){this.startListen(e)},startListen:function(e){var i;i=e,["log","error","warn","info","debug","trace"].forEach(function(r){var o=Mt[r];console[r]=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{o.apply(console,t),!i.isWhiteList&&["log","info","debug","trace"].includes(r)||(e=t.map(function(e){if("object"==typeof e&&null!==e)try{return JSON.stringify(e)}catch(e){}return String(e)}).join(" "),i.normalLogPipeline({msg:"method: console."+r+"\nmessage: "+e,level:X.CONSOLE_LOG,errorMsg:"",originFrom:i.getOriginFrom()}))}catch(e){Mt.error("Console hook error:",e)}}})},destroy:function(){Object.keys(Mt).forEach(function(e){console[e]=Mt[e]})}});function Ft(){lt=[],at=-1,l=null,ht(addEventListener)}ct={passive:!0,capture:!0},ut=new Date,dt=function(e,t){l||(l=t,at=e,st=new Date,ht(removeEventListener),ft())},ft=function(){var t;0<=at&&at<st-ut&&(t={entryType:"first-input",name:l.type,target:l.target,cancelable:l.cancelable,startTime:l.timeStamp,processingStart:l.timeStamp+at},lt.forEach(function(e){e(t)}),lt=[])},pt=function(e){var t,n,r,o,i,a;e.cancelable&&(t=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,"pointerdown"==e.type?(n=t,r=e,o=function(){dt(n,r),a()},i=function(){a()},a=function(){removeEventListener("pointerup",o,ct),removeEventListener("pointercancel",i,ct)},addEventListener("pointerup",o,ct),addEventListener("pointercancel",i,ct)):dt(t,e))},ht=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return t(e,pt,ct)})},mt="hidden"===document.visibilityState?0:1/0,addEventListener("visibilitychange",function e(t){"hidden"===document.visibilityState&&(mt=t.timeStamp,removeEventListener("visibilitychange",e,!0))},!0),Ft(),self.webVitals={firstInputPolyfill:function(e){lt.push(e),ft()},resetFirstInputPolyfill:Ft,get firstHiddenTime(){return mt}};function w(e,t){var n=rn(),r="navigate";return 0<=tn?r="back-forward-cache":n&&(document.prerendering||0<on()?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}}function _t(e,t,n){try{var r;if(PerformanceObserver.supportedEntryTypes.includes(e))return(r=new PerformanceObserver(function(e){Promise.resolve().then(function(){t(e.getEntries())})})).observe(Object.assign({type:e,buffered:!0},n||{})),r}catch(e){}}function b(t,n,r,o){var i,a;return function(e){0<=n.value&&(e||o)&&((a=n.value-(i||0))||void 0===i)&&(i=n.value,n.delta=a,n.rating=(e=n.value)>r[1]?"poor":e>r[0]?"needs-improvement":"good",t(n))}}function Ht(e){requestAnimationFrame(function(){return requestAnimationFrame(function(){return e()})})}function Ut(t){function e(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||t(e)}addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)}function Dt(t){var n=!1;return function(e){n||(t(e),n=!0)}}function qt(){return an<0&&(an=sn(),cn(),nn(function(){setTimeout(function(){an=sn(),cn()},0)})),{get firstHiddenTime(){return an}}}function jt(e){document.prerendering?addEventListener("prerenderingchange",function(){return e()},!0):e()}function Wt(i,a){a=a||{},jt(function(){var t,n=qt(),r=w("FCP"),o=_t("paint",function(e){e.forEach(function(e){"first-contentful-paint"===e.name&&(o.disconnect(),e.startTime<n.firstHiddenTime)&&(r.value=Math.max(e.startTime-on(),0),r.entries.push(e),t(!0))})});o&&(t=b(i,r,dn,a.reportAllChanges),nn(function(e){r=w("FCP"),t=b(i,r,dn,a.reportAllChanges),Ht(function(){r.value=performance.now()-e.timeStamp,t(!0)})}))})}function Bt(e){var t,n,r,o,i,a;e.cancelable&&(t=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,"pointerdown"==e.type?(n=t,r=e,o=function(){mn(n,r),a()},i=function(){a()},a=function(){removeEventListener("pointerup",o,pn),removeEventListener("pointercancel",i,pn)},addEventListener("pointerup",o,pn),addEventListener("pointercancel",i,pn)):mn(t,e))}function Gt(e){e.forEach(function(e){e.interactionId&&(bn=Math.min(bn,e.interactionId),En=Math.max(En,e.interactionId),wn=En?(En-bn)/7+1:0)})}function zt(){return Rn()-Tn}function Jt(e){var t=O[O.length-1],n=On[e.interactionId];(n||O.length<10||e.duration>t.latency)&&(n?(n.entries.push(e),n.latency=Math.max(n.latency,e.duration)):(t={id:e.interactionId,latency:e.duration,entries:[e]},On[t.id]=t,O.push(t)),O.sort(function(e,t){return t.latency-e.latency}),O.splice(10).forEach(function(e){delete On[e.id]}))}function Vt(e,t){function n(t,n,r,o){function i(e){"visibilitychange"===t&&"hidden"!==document.visibilityState||(o?setTimeout(function(){return n(e)},o):n(e),r&&removeEventListener(t,i,!0))}addEventListener(t,i,!0)}var r;n("visibilitychange",e,null==t?void 0:t.once,null==(r=null==t?void 0:t.delay)?void 0:r.visibilitychange),n("pagehide",e,null==t?void 0:t.once,null==(r=null==t?void 0:t.delay)?void 0:r.pagehide),n("beforeunload",e,null==t?void 0:t.once,null==(r=null==t?void 0:t.delay)?void 0:r.beforeunload)}function Xt(e){var t=e.name;0<(e=e.value)&&(x[t]=e)}function E(e,t,n,r){return void 0===n&&(n=15e3),void 0===r&&(r=0),(t=void 0===t?0:t)<=e&&e<=n?e:r}var R,$t,Kt,Yt,Qt,T,Zt,en,tn=-1,nn=function(t){addEventListener("pageshow",function(e){e.persisted&&(tn=e.timeStamp,t(e))},!0)},rn=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},on=function(){var e=rn();return e&&e.activationStart||0},an=-1,sn=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},ln=function(e){"hidden"===document.visibilityState&&-1<an&&(an="visibilitychange"===e.type?e.timeStamp:0,un())},cn=function(){addEventListener("visibilitychange",ln,!0),addEventListener("prerenderingchange",ln,!0)},un=function(){removeEventListener("visibilitychange",ln,!0),removeEventListener("prerenderingchange",ln,!0)},dn=[1800,3e3],fn=[.1,.25],pn={passive:!0,capture:!0},hn=new Date,mn=function(e,t){R||(R=t,$t=e,Kt=new Date,vn(removeEventListener),gn())},gn=function(){var t;0<=$t&&$t<Kt-hn&&(t={entryType:"first-input",name:R.type,target:R.target,cancelable:R.cancelable,startTime:R.timeStamp,processingStart:R.timeStamp+$t},Yt.forEach(function(e){e(t)}),Yt=[])},vn=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return t(e,Bt,pn)})},yn=[100,300],wn=0,bn=1/0,En=0,Rn=function(){return Qt?wn:performance.interactionCount||0},Sn=[200,500],Tn=0,O=[],On={},xn=[2500,4e3],Pn={},Ln=(L.prototype.start=function(){var t=this,n=new PerformanceObserver(function(e){e=e.getEntriesByName("first-contentful-paint");0<e.length&&(t.fcp=e[0].startTime,t.slientWindowStartTime=t.fcp,n.disconnect(),setTimeout(function(){t.checkTTI()},Math.max(t.slienceTimeInterval-(performance.now()-t.fcp)+20,1)))});n.observe({entryTypes:["paint"]}),this.longtaskObserver=new PerformanceObserver(function(e){e=e.getEntries();t.longTaskEntries=t.longTaskEntries.concat(e)}),this.longtaskObserver.observe({entryTypes:["longtask"]}),this.resourceObserver=new PerformanceObserver(function(e){e=e.getEntries();t.resourceEntries=t.resourceEntries.concat(e)}),this.resourceObserver.observe({entryTypes:["resource"]})},L.prototype.checkTTI=function(){var e=this;this.hasSlientWindow()?(this.calculateTTI(),this.longtaskObserver.disconnect(),this.resourceObserver.disconnect()):setTimeout(function(){e.checkTTI()},this.checkInterval)},L.prototype.hasSlientWindow=function(){var e,t=performance.now();return!(t-this.slientWindowStartTime<5e3||((e=this.getLastLongTaskEndTime())>this.slientWindowStartTime?(this.slientWindowStartTime=e,this.resourceEntries=[]):this.getRequestCount(this.slientWindowStartTime,t)<=2?(this.lastLongtaskEndTime=e,0):(t=this.resourceEntries.sort(function(e,t){return e.startTime-t.startTime}),this.slientWindowStartTime=t[this.resourceEntries.length-2].startTime,1)))},L.prototype.getLastLongTaskEndTime=function(){var t;return 0===this.longTaskEntries.length?-1:(t=0,this.longTaskEntries.forEach(function(e){e.startTime+e.duration>t&&(t=e.startTime+e.duration)}),t)},L.prototype.getRequestCount=function(t,n){var r=0;return this.resourceEntries.forEach(function(e){e.startTime>=t&&e.startTime+e.duration<=n&&(r+=1)}),r},L.prototype.calculateTTI=function(){var e=-1===this.lastLongtaskEndTime?this.slientWindowStartTime:this.lastLongtaskEndTime,t=performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart,e=Math.max(t,e);this.onTTICallback(e)},L),x=(new n({name:"webVitals"}),{FCP:-1,LCP:-1,FID:-1,CLS:-1,INP:-1,TTI:-1,from:void 0}),Cn=new Map,kn=new n({name:"webVitals",onNewAegis:function(e){var t,n,i,a,s,l,c,u,d,f,r=this;if(Fe()&&"function"==typeof window.PerformanceObserver&&"function"==typeof performance.getEntriesByName)try{Cn.set(e,{isWebVitalsReported:!1,hasFirstEntry:!1,custom:null}),Wt(Xt),d=Xt,f={},jt(function(){function e(e){(e=e[e.length-1])&&e.startTime<r.firstHiddenTime&&(o.value=Math.max(e.startTime-on(),0),o.entries=[e],t())}var t,n,r=qt(),o=w("LCP"),i=_t("largest-contentful-paint",e);i&&(t=b(d,o,xn,f.reportAllChanges),n=Dt(function(){Pn[o.id]||(e(i.takeRecords()),i.disconnect(),Pn[o.id]=!0,t(!0))}),["keydown","click"].forEach(function(e){addEventListener(e,function(){return setTimeout(n,0)},!0)}),Ut(n),nn(function(e){o=w("LCP"),t=b(d,o,xn,f.reportAllChanges),Ht(function(){o.value=performance.now()-e.timeStamp,Pn[o.id]=!0,t(!0)})}))}),c=Xt,u={},jt(function(){function t(e){e.startTime<n.firstHiddenTime&&(r.value=e.processingStart-e.startTime,r.entries.push(e),i(!0))}function e(e){e.forEach(t)}var n=qt(),r=w("FID"),o=_t("first-input",e),i=b(c,r,yn,u.reportAllChanges);o&&Ut(Dt(function(){e(o.takeRecords()),o.disconnect()})),o&&nn(function(){r=w("FID"),i=b(c,r,yn,u.reportAllChanges),Yt=[],$t=-1,R=null,vn(addEventListener),Yt.push(t),gn()})}),s=Xt,l={},Wt(Dt(function(){function e(e){e.forEach(function(e){var t,n;e.hadRecentInput||(t=o[0],n=o[o.length-1],r&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,o.push(e)):(r=e.value,o=[e]))}),r>n.value&&(n.value=r,n.entries=o,t())}var t,n=w("CLS",0),r=0,o=[],i=_t("layout-shift",e);i&&(t=b(s,n,fn,l.reportAllChanges),Ut(function(){e(i.takeRecords()),t(!0)}),nn(function(){n=w("CLS",r=0),t=b(s,n,fn,l.reportAllChanges),Ht(function(){return t()})}),setTimeout(t,0))})),i=Xt,a={},jt(function(){var e;"interactionCount"in performance||(Qt=Qt||_t("event",Gt,{type:"event",buffered:!0,durationThreshold:0}));function t(e){e.forEach(function(t){t.interactionId&&Jt(t),"first-input"!==t.entryType||O.some(function(e){return e.entries.some(function(e){return t.duration===e.duration&&t.startTime===e.startTime})})||Jt(t)}),e=Math.min(O.length-1,Math.floor(zt()/50)),(e=O[e])&&e.latency!==n.value&&(n.value=e.latency,n.entries=e.entries,o())}var n=w("INP"),r=_t("event",t,{durationThreshold:null!=(e=a.durationThreshold)?e:40}),o=b(i,n,Sn,a.reportAllChanges);r&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&r.observe({type:"first-input",buffered:!0}),Ut(function(){t(r.takeRecords()),n.value<0&&0<zt()&&(n.value=0,n.entries=[]),o(!0)}),nn(function(){O=[],Tn=Rn(),n=w("INP"),o=b(i,n,Sn,a.reportAllChanges)}))}),n=function(e){Xt({name:"TTI",value:e})},Fe()&&new Ln(n).start(),Vt(function(){r.tryReport(e,null,"onHidden")},{once:!0,delay:{visibilitychange:10}}),x.from=null==(t=e)?void 0:t.getCurrentPageUrl()}catch(e){}},tryReport:function(t,n,r){var o=this;void 0===r&&(r="manual"),this.$walk(function(e){e===t&&("object"==typeof(e=o.$getConfig(t))&&!0===e.manualReport||"onHidden"!==r?(e=Cn.get(t))&&!e.hasFirstEntry?(e.hasFirstEntry=!0,"manual"===r&&n&&(e.custom=n)):o.doReport(t,(null==e?void 0:e.custom)||n):o.doReport(t,null))})},doReport:function(n,r){var e=Cn.get(n);if(e){if(null!=e&&e.isWebVitalsReported)return;e.isWebVitalsReported=!0}this.$walk(function(i){var e,t;i===n&&(t=V({},x),r&&Object.keys(r).forEach(function(e){null!=r[e]&&(t[e]=r[e])}),null!=(e=i.sendPipeline))&&e.call(i,[function(e,t){var n,r=[];for(n in e)"from"!==n&&r.push(n+"="+e[n]);var o=-1===(null==(o=null==(o=i.config)?void 0:o.performanceUrl)?void 0:o.indexOf("?"))?"?":"&";t({url:i.config.webVitalsUrl+o+r.join("&"),type:m.VITALS,log:e,sendBeacon:!0})}],m.VITALS)(t)})},publish:function(e,t){this.tryReport(e,t,"manual")},destroy:function(){this.option.publish=function(){}}}),In=(new n({name:"pagePerformance"}),3),An=new Map,Mn=new n({name:"pagePerformance",performanceMap:{},onNewAegis:function(t){var e;Fe()&&(An.set(t,{isPagePerformanceReported:!1}),T?this.publish(T,t):this.startCalcPerformance(t),e=this.publishWhenObHidden.bind(this,t),Vt(e,{once:!0}),t.lifeCycle.on("destroy",function(){var e=An.get(t);e&&(e.isPagePerformanceReported=!1)}))},publishWhenObHidden:function(e){var t,n=An.get(e);if(null==n||!n.isPagePerformanceReported){n=0;if(null!=(t=e.firstScreenInfo)&&t.timing)n=e.firstScreenInfo.timing;else if(_e("paint"))try{var r,o=performance.getEntriesByName("first-contentful-paint");o&&0<o.length&&(r=o[0])&&0<r.startTime&&(n=r.startTime)}catch(e){}(T=this.buildPerformanceLog(e,n,this.getPageUrl(e),window.location.href))&&this.publish(T,e,!0)}},buildPerformanceLog:function(e,t,n,r){var o=performance.timing;if(o)return n={from:n,originFrom:r,dnsLookup:E(o.domainLookupEnd-o.domainLookupStart),tcp:E(o.connectEnd-o.connectStart),ssl:E(0===o.secureConnectionStart?0:o.requestStart-o.secureConnectionStart),ttfb:E(o.responseStart-o.requestStart),contentDownload:E(o.responseEnd-o.responseStart),domParse:E(o.domInteractive-o.domLoading,0,15e3,1070),resourceDownload:E(o.loadEventStart-o.domInteractive,0,15e3,1070),firstScreenTiming:E(Math.floor(t),0,15e3,15e3)},(r=e.config).extraPerformanceData&&"{}"!==JSON.stringify(r.extraPerformanceData)&&(t=(o=r.extraPerformanceData).engineInit,e=o.bundleLoad,n=V(V({},n),{engineInit:E(t,0,1e4),bundleLoad:E(e,0,1e4)})),n},publish:function(a,s,l){var c=this;void 0===l&&(l=!1),this.$walk(function(i){var e,o;i===s&&((e=An.get(i))&&(e.isPagePerformanceReported=!0),o=a.originFrom||window.location.href,a.originFrom&&delete a.originFrom,i.sendPipeline([function(e,t){var n,r,o=[];for(n in e)"from"!==n&&o.push(n+"="+e[n]);if(c.$getConfig(i))return r=-1===(null==(r=i.config.performanceUrl)?void 0:r.indexOf("?"))?"?":"&",t({url:i.config.performanceUrl+r+o.join("&"),type:m.PERFORMANCE,log:e,sendBeacon:l})}],m.PERFORMANCE)(V({},a)),setTimeout(function(){var e=["duration: "+(a.dnsLookup+a.tcp+a.ssl+a.ttfb+a.contentDownload+a.domParse+a.resourceDownload)+"ms","firstScreenTiming: "+a.firstScreenTiming+"ms","dnsLookup: "+a.dnsLookup+"ms","tcp: "+a.tcp+"ms","ssl: "+a.ssl+"ms","ttfb: "+a.ttfb+"ms","contentDownload: "+a.contentDownload+"ms","domParse: "+a.domParse+"ms","resourceDownload: "+a.resourceDownload+"ms","lcp: "+x.LCP+"ms","fid: "+x.FID+"ms","cls: "+x.CLS+"ms","fcp: "+x.FCP+"ms",a.engineInit?"engineInit: "+a.engineInit+"ms":"",a.bundleLoad?"bundleLoad: "+a.bundleLoad+"ms":""].filter(function(e){return e}).join("\n\n"),t=c.$getConfig(i),n=!1;if("function"==typeof(null==t?void 0:t.isSlowPage))try{n=null==t?void 0:t.isSlowPage(a,x)}catch(e){return void console.warn("[Aegis] isSlowPage function happen error:",e,", this data will not be reported.")}else null!=t&&t.slowPageThreshold&&"number"==typeof t.slowPageThreshold?a.firstScreenTiming>(null==t?void 0:t.slowPageThreshold)&&(n=!0):n=1e3<a.firstScreenTiming;var t=s.config.pageLoadLog,r=s.config.slowPageLoadLog&&n,e={msg:e,ext1:(null==(e=a.firstScreenTiming)?void 0:e.toString())||"",level:n?X.SLOW_PAGE_LOAD:X.PAGE_LOAD,errorMsg:"",originFrom:o};(t||r)&&i.normalLogPipeline(e)},3e3))})},getPageUrl:function(e){var t=this.$getConfig(e);if(null!=t&&t.urlHandler&&"function"==typeof(null==t?void 0:t.urlHandler)){t=null==t?void 0:t.urlHandler();if(t)return encodeURIComponent(t)}return e.getCurrentPageUrl()},startCalcPerformance:function(t){var n=this;try{var r=this.getPageUrl(t),o=t.getOriginFrom();this.getFirstScreenTiming(t,function(e){T=n.buildPerformanceLog(t,e,r,o);e=An.get(t);!T||null!=e&&e.isPagePerformanceReported||n.publish(T,t)})}catch(t){}},getFirstScreenTiming:function(s,l){var c=this;s.lifeCycle.on("destroy",function(){g&&clearTimeout(g)});var u,d=this,n=["script","style","link","br"],f=[],p={},h=(_e("paint")&&(u=new PerformanceObserver(function(e){e.getEntries().forEach(function(e){var t;"paint"===e.entryType&&"first-contentful-paint"===e.name&&0<(t=document.querySelectorAll("[AEGIS-FIRST-SCREEN-TIMING]")).length&&s.config.id&&!c.performanceMap[s.config.id]&&(c.setFirstScreenInfo(s,e.startTime,t[0],t),null!=l&&l(e.startTime),h.disconnect(),u.disconnect(),g)&&clearTimeout(g)})})).observe({entryTypes:["paint"]}),new MutationObserver(function(e){var t={roots:[],ignores:[],rootsDomNum:[],time:performance.now()};e.forEach(function(e){e&&e.addedNodes&&Array.prototype.slice.call(e.addedNodes).forEach(function(e){d.isEleInArray(e,t.ignores)?t.ignores.push(e):1===e.nodeType&&e.hasAttribute("AEGIS-FIRST-SCREEN-TIMING")?(Object.prototype.hasOwnProperty.apply(p,[t.time])||(p[t.time]=[]),p[t.time].push(e)):1===e.nodeType&&(d.hasAncestorOrSelfWithAttribute(e,"AEGIS-IGNORE-FIRST-SCREEN-TIMING")?t.ignores.push(e):-1!==n.indexOf(e.nodeName.toLocaleLowerCase())||d.isEleInArray(e,t.roots)||(t.roots.push(e),t.rootsDomNum.push(d.walkAndCount(e)||0)))})}),t.roots.length&&f.push(t)})),m=(h.observe(document,{childList:!0,subtree:!0}),function(n){(n=void 0===n?0:n)||(r=0,(e=Object.keys(p)).length?(n=Math.max.apply(null,e),c.setFirstScreenInfo(s,n,null==(e=p[n])?void 0:e[0],p)):f.forEach(function(e){for(var t=0;t<e.roots.length;t++)e.rootsDomNum[t]>r&&d.isInFirstScreen(e.roots[t])&&(r=e.rootsDomNum[t],n=e.time,c.setFirstScreenInfo(s,n,e.roots[t]))}),f.length=0,Object.keys(p).forEach(function(e){p[e]=p[e].map(function(e){var t={tagName:e.tagName},n=e.attributes;if(!n)return e;for(var r=0;r<n.length;r++){var o=n[r];o.name&&(t[o.name]=e.getAttribute(o.name))}return t})}));var r,e=performance.timing,t=e.domInteractive-e.domLoading,o=n;g=null;for(var i=0,a=[t,e.loadEventStart-e.domInteractive,o];i<a.length;i++)if(a[i]<=0&&0<In){g=setTimeout(function(){return m(o)},3e3);break}g?--In:(h.disconnect(),null!=u&&u.disconnect(),null!=l&&l(n))}),g=setTimeout(function(){return m()},3e3)},setFirstScreenInfo:function(e,t,n,r){var o;e.config.id&&this.performanceMap[e.config.id]||(e.config.id&&(this.performanceMap[e.config.id]=!0),("object"!=typeof(null==(o=e.config)?void 0:o.pagePerformance)||null!=(o=e.config.pagePerformance)&&o.firstScreenInfo)&&(e.firstScreenInfo={element:n,timing:t,markDoms:r}))},isEleInArray:function(e,t){return!(!e||e===document.documentElement)&&(-1!==t.indexOf(e)||this.isEleInArray(e.parentElement,t))},isInFirstScreen:function(e){var t;return!(!e||"function"!=typeof e.getBoundingClientRect)&&(e=e.getBoundingClientRect(),t=window.innerHeight,0<=e.left)&&e.left<window.innerWidth&&0<=e.top&&e.top<t&&0<e.width&&0<e.height},walkAndCount:function(e){var t=0;if(e&&1===e.nodeType){t+=1;var n=e.children;if(null!=n&&n.length)for(var r=0;r<n.length;r++)1===n[r].nodeType&&n[r].hasAttribute("AEGIS-IGNORE-FIRST-SCREEN-TIMING")||(t+=this.walkAndCount(n[r]))}return t},hasAncestorOrSelfWithAttribute:function(e,t){for(var n=e;n&&n!==document.body;){if(n.hasAttribute(t))return!0;n=n.parentElement}return!1}}),Nn=(new n({name:"spa"}),["replaceState","pushState","popstate","hashchange"]),Fn=new n({name:"spa",originFireUrl:"",onNewAegis:function(t){var n=this;history.pushState=this.wr("pushState")||history.pushState,history.replaceState=this.wr("replaceState")||history.replaceState,this.sendPv=this.sendPv.bind(this),t.config.spa&&this.sendPv(t),Nn.forEach(function(e){return window.addEventListener(e,function(){return n.sendPv.call(n,t)})})},wr:function(n){var r=history[n],e="__"+n+"__hasWrittenByTamSpa";return"function"==typeof r&&!history[e]&&(Object.defineProperty(history,e,{value:!0,enumerable:!1}),function(){var e=r.apply(this,arguments),t=null;return"function"==typeof Event?t=new Event(n):(t=document.createEvent("HTMLEvents")).initEvent(n,!1,!0),window.dispatchEvent(t),e})},sendPv:function(o){var n=this;setTimeout(function(){var t=location.pathname+location.hash+o.config.id;n.$walk(function(e){var r;e===o&&(r=e.config.pvUrl)&&t&&t!==n.originFireUrl&&(e.sendPipeline([function(e,t){var n=null!=r&&r.includes("?")?"&":"?";t({url:r+n+"originFrom="+encodeURIComponent(o.getOriginFrom()),type:m.PV})}],m.PV)(null),n.originFireUrl=t)})},0)},destroy:function(){this.option.sendPv=function(){}}}),e=(M(en=P,e=Zt=e),en.prototype=null===e?Object.create(e):(_n.prototype=e.prototype,new _n),P.prototype.addExtBean=function(e,t){t&&this.extendBean(e,encodeURIComponent("string"==typeof t&&["ext1","ext2","ext3"].includes(e)?t.slice(0,1024):t))},P.prototype.getBean=function(t){var n=this;return void 0===t&&(t=[]),""+Object.getOwnPropertyNames(this.bean).filter(function(e){return-1===t.indexOf(e)}).map(function(e){return"from"===e?"from="+n.getCurrentPageUrl():e+"="+n.bean[e]}).join("&")},P.prototype.getCurrentPageUrl=function(){var e=this.config.pageUrl||location.href,e=(e="function"==typeof this.config.urlHandler?this.config.urlHandler()||location.href:e).slice(0,2048);return encodeURIComponent(e)},P.prototype.getOriginFrom=function(){try{return("undefined"!=typeof window&&window.location?window.location.href:"").slice(0,2048)}catch(e){return""}},P.prototype.ready=function(){function i(){var e,n,r,o;t.reportRequestQueue.length&&(e=t.reportRequestQueue.splice(0,1)[0],n=e.options,r=e.success,o=e.fail,t.$request(n,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return null==r?void 0:r.apply(n,e)}finally{i()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return null==o?void 0:o.apply(n,e)}finally{i()}}))}var t=this;i(),this.isReportReady=!0},P.prototype.request=function(l,n,c){var u,d,f=this;this.config.reportImmediately||this.isReportReady?this.$request(l,u=function(e){var t=JSON.parse(localStorage.getItem("aegis-web-retry-report-requests")||"[]");null!=t&&t.length&&l.extraRetryOptions&&(t.splice(t.findIndex(function(e){return e.extraRetryOptions.requestId===l.extraRetryOptions.requestId}),1),localStorage.setItem("aegis-web-retry-report-requests",JSON.stringify(t)),delete window[l.extraRetryOptions.success],delete window[l.extraRetryOptions.fail]),null!=n&&n(e)},d=function(e){if(!f.config.reportRetry)return null==c?void 0:c(e);var t,n="boolean"==typeof f.config.reportRetry?wt:V(V({},wt),f.config.reportRetry),r=n.maxRetryCount,o=void 0===r?wt.maxRetryCount:r,r=n.retryInterval,r=void 0===r?wt.retryInterval:r,n=n.whenRetryEndStillFail,i=void 0===n?wt.whenRetryEndStillFail:n,a=(l.extraRetryOptions||(l.extraRetryOptions={requestId:"",retriedCount:0,success:"",fail:""}),l.extraRetryOptions),s=(a.requestId=a.requestId||l.url+"-"+Date.now()+"-"+Math.random(),a.requestId),n=(a.retriedCount=a.retriedCount||0,a.success=a.success||s+"_successCallback",a.fail=a.fail||s+"_failCallback",JSON.parse(localStorage.getItem("aegis-web-retry-report-requests")||"[]"));n.find(function(e){return e.extraRetryOptions.requestId===s})?(t=n.findIndex(function(e){return e.extraRetryOptions.requestId===s}),n[t]=l):n.push(l),localStorage.setItem("aegis-web-retry-report-requests",JSON.stringify(n)),setTimeout(function(){console.log("failCallback retry",a.retriedCount,i),a.retriedCount<o?(l.extraRetryOptions.retriedCount+=1,f.$request(l,u,d)):"discard"===i&&localStorage.removeItem("aegis-web-retry-report-requests")},"function"==typeof r?r(l.extraRetryOptions.retriedCount):r),null!=c&&c(e),window[a.success]||(window[a.success]=u),window[a.fail]||(window[a.fail]=d)}):this.reportRequestQueue.push({options:l,success:n,fail:c})},P.prototype.$request=function(s,e,t){var n,r,o,i;if(s&&"string"==typeof s.url&&""!==s.url&&this.bean.id)return i=s.url,!1!==s.addBean&&(i=((e,t)=>{var n,r,o,i=e,a=s.beanFilter||[];for(n in t)-1===a.indexOf(n)&&((o=(r=new RegExp("([?&])"+n+"(=([^&]*))?(?=&|$)")).exec(i))?o[2]&&""!==o[3]&&"undefined"!==o[3]||(i=i.replace(r,"$1"+n+"="+t[n])):(o=-1<i.indexOf("?")?"&":"?",i+=o+n+"="+t[n]));return i})(i,V(V({},this.bean),{from:this.getCurrentPageUrl()}))),s.url=i,i=s.method||"get",r=this.config.onBeforeRequest,(s=r?r(s,this):s)?s.url?void((null!=s&&s.sendBeacon||this.sendNow)&&"function"==typeof(null==navigator?void 0:navigator.sendBeacon)?navigator.sendBeacon(s.url,s.data):((n=new XMLHttpRequest).sendByAegis=!0,n.addEventListener("readystatechange",function(){4===n.readyState&&(400<=n.status||0===n.status?null!=t&&t(n.response):null!=e&&e(n.response))}),"get"===i.toLocaleLowerCase()?(n.open("get",(r=s.url,o=s.data,"string"!=typeof r?"":"object"==typeof o&&o?(i=Object.getOwnPropertyNames(o).map(function(e){var t=o[e];return e+"="+("string"==typeof t?encodeURIComponent(t):encodeURIComponent(JSON.stringify(t)))}).join("&").replace(/eval/gi,"evaI"),r+(-1===r.indexOf("?")?"?":"&")+i):r)),n.send()):(n.open("post",s.url),s.contentType&&n.setRequestHeader("Content-Type",s.contentType),"string"==typeof s.data&&(s.data=s.data.replace(/eval/gi,"evaI")),n.send(s.data)))):console.warn("Please handle the parameters reasonably, options.url is necessary"):console.warn("Sending request blocked")},P.prototype.publishPluginsLogs=function(){var e=P.installedPlugins.find(function(e){return"reportAssetSpeed"===e.name});null!=e&&e.option.collectNotReportedLog(this)},P.prototype.uploadLogs=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={}),null!=(n=this.lifeCycle)&&n.emit("uploadLogs",e,t)},P.prototype.reportWebVitals=function(e){try{var t=P.installedPlugins.find(function(e){return"webVitals"===e.name});t&&this.config.webVitals&&this.config.webVitals.manualReport&&t.option.publish(this,e)}catch(e){}},P.sessionID="session-"+Le(),P);function P(e){var t,n,r,o,i,a,s=Zt.call(this,e)||this;s.sendNow=!1,s.isReportReady=!1,s.reportRequestQueue=[],s.speedLogPipeline=Me([Z(s),(a=s.config,function(e,t){var n,r,o,i="number"==typeof a.repeat?a.repeat:60;!a.speedSample||i<=0?t(e):(n=(null==a?void 0:a.id)||"0",r=Ee[n]||{},Array.isArray(e)?(o=e.filter(function(e){var t=!r[e.url]||r[e.url]<i;return t?(r[e.url]=1+~~r[e.url],Ee[n]=r):v[n]||Re(n),t})).length&&t(o):!r[e.url]||r[e.url]<i?(r[e.url]=1+~~r[e.url],Ee[n]=r,t(e)):v[n]||Re(n))}),(r=s,function(t,n){St(function(e){r.extendBean("netType",e),n(t)})}),function(e,t){null!=(n=s.lifeCycle)&&n.emit("beforeReportSpeed",e);var n,r=s.config.beforeReportSpeed;if((e="function"==typeof r?e.filter(function(e){return!1!==r(e)}):e).length)return t(e)},function(e,t){t(e.map(function(e){return void 0!==e.payload&&delete e.payload,e}))},function(e){return s.sendPipeline([function(e,t){t({type:m.SPEED,url:""+s.config.speedUrl,method:"post",data:Y(e,V(V({},s.bean),{from:s.getCurrentPageUrl()})),log:e})}],m.SPEED)(e)}]),e.asyncPlugin=!0;try{"undefined"!=typeof document&&(e.uin=e.uin||(null!=(t=document.cookie.match(/\buin=\D+(\d*)/))?t:[])[1]||(null!=(n=document.cookie.match(/\bilive_uin=\D*(\d+)/))?n:[])[1]||""),s.init(e),s.extendBean("sessionId",P.sessionID),s.extendBean("from",s.getCurrentPageUrl()),"undefined"!=typeof document&&s.extendBean("referer",encodeURIComponent(document.referrer||"")),o=JSON.parse(localStorage.getItem("aegis-web-retry-report-requests")||"[]"),(i=function(){var r;o.length&&(r=o.splice(0,1)[0],localStorage.setItem("aegis-web-retry-report-requests",JSON.stringify(o)),s.$request(r,function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return null==(e=window[r.extraRetryOptions.success])?void 0:e.apply(r,t)}finally{i()}},function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return null==(e=window[r.extraRetryOptions.fail])?void 0:e.apply(r,t)}finally{i()}}))})();for(var l=1;l<=10;l++)s.addExtBean("ext"+l,e["ext"+l])}catch(e){console.warn(e),console.log("%cThe above error occurred in the process of initializing Aegis, which will affect your normal use of Aegis.\nIt is recommended that you contact us for feedback and thank you for your support.","color: red"),s.sendSDKError(e)}return s}function _n(){this.constructor=en}function L(e){this.slienceTimeInterval=5e3,this.checkInterval=100,this.fcp=0,this.longTaskEntries=[],this.resourceEntries=[],this.slientWindowStartTime=performance.now(),this.onTTICallback=e}new n({name:"ie"}),new n({name:"onClose"});var Hn=new n({name:"onClose",onNewAegis:function(n){var r,o=this;i.desktop()?(r=window.onunload,window.onunload=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.publishNotReportedLog(n),null!=r&&r.call.apply(r,u([window],e))}):Vt(this.publishNotReportedLog.bind(this,n),{once:!0})},publishNotReportedLog:function(t){var n=this;this.$walk(function(e){e===t&&(e.sendNow=!0,e.publishPluginsLogs(),n.publishThrottlePipeLogs(e))})},publishThrottlePipeLogs:function(e){null!=e&&e.speedLogPipeline([]),null!=e&&e.eventPipeline([]),null!=e&&e.customTimePipeline([]),null!=e&&e.normalLogPipeline([])}});new n({name:"aid"});var Un,Dn={containers:["body","html","#app","#root"],ignoreContainers:[],detectStartPosition:{x:0,y:0},emptyElementsPercent:70,sameElementsPercent:70,debounceDuration:2e3,everySideSampleNumber:9,disableSameElementsCheck:!0,ignoreElesWhenDomChange:[],reDetectInterval:2e3,samePointDepth:5,customBlankScreenDector:null,enableScreenshot:!1,screenshotQuality:.1,screenshotFormat:"image/webp"},qn=["canvas","img","svg","iframe"];function jn(e){var e=e.toString(),t=e.indexOf(".");return-1===t?0:e.length-t-1}(C=Un=Un||{})[C.UNKNOWN=0]="UNKNOWN",C[C.ERROR=1]="ERROR",C[C.DOM_CHANGE=2]="DOM_CHANGE";function Wn(e,t,n){var r=(e=e.map(function(e){return zn(e)}))[0];return r?(t=t.some(function(e){return r.includes(e)}),n=!n.some(function(e){return r.includes(e)}),{isWhitePoint:t&&n,selectorPointers:e}):{isWhitePoint:!1,selectorPointers:e}}function Bn(e){try{var t=e.config.blankScreen;return!0===t?Dn:Jn(Dn,t)}catch(e){return Dn}}function Gn(n,r){function o(e){var t=e[0];return t&&null!==t.shadowRoot&&(t=(null==(t=null==t?void 0:t.shadowRoot)?void 0:t.elementsFromPoint(n,r))||[]).length>e.length?o(t||[]):e}var e=document.elementsFromPoint(n,r);return o(e)}var me={add:function(){for(var e,n,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return 0===t.length?0:1===t.length?t[0]:(e=Math.max.apply(Math,t.map(jn)),n=Math.pow(10,e),t.reduce(function(e,t){return e+Math.round(t*n)},0)/n)},minus:function(){for(var n,e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return 0===t.length?0:1===t.length?t[0]:(e=Math.max.apply(Math,t.map(jn)),n=Math.pow(10,e),e=t[0],t.slice(1).reduce(function(e,t){return e-Math.round(t*n)},Math.round(e*n))/n)},times:function(){for(var n,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?0:1===e.length?e[0]:(n=1,e.map(function(e){var t=jn(e),t=Math.pow(10,t);return n*=t,Math.round(e*t)}).reduce(function(e,t){return e*t},1)/n)},divide:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 0===t.length?0:1===t.length?t[0]:t.slice(1).some(function(e){return 0===e})?NaN:(e=t[0],t.slice(1).reduce(function(e,t){var n=jn(e),r=jn(t),n=Math.pow(10,n),r=Math.pow(10,r);return Math.round(e*n)/Math.round(t*r)*(r/n)},e))}},zn=function(e){var t=e.nodeName.toLowerCase();return e.id?t+"#"+e.id:e.className&&"string"==typeof e.className?t+"."+e.className.split(" ").filter(function(e){return!!e}).join("."):t},Jn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!t.length)return e;var r,o=t.shift();for(r in o)"object"==typeof o[r]&&null!==o[r]&&e.hasOwnProperty(r)&&"object"==typeof e[r]&&null!==e[r]?Jn(e[r],o[r]):e[r]=o[r];return Jn.apply(void 0,u([e],t))},ge=function(e){var t,n,r,o;return!e.startsWith("#")&&(r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/))?(t=parseInt(r[1],10),n=parseInt(r[2],10),r=parseInt(r[3],10),"#"+(o=function(e){e=e.toString(16);return 1===e.length?"0"+e:e})(t)+o(n)+o(r)):e},Vn=function(e,t,n,r,o,i){"function"==typeof e.roundRect?e.roundRect(t,n,r,o,i):(e.moveTo(t+i,n),e.lineTo(t+r-i,n),e.arcTo(t+r,n,t+r,n+i,i),e.lineTo(t+r,n+o-i),e.arcTo(t+r,n+o,t+r-i,n+o,i),e.lineTo(t+i,n+o),e.arcTo(t,n+o,t,n+o-i,i),e.lineTo(t,n+i),e.arcTo(t,n,t+i,n,i),e.closePath())};function Xn(le,ce,ue,de,fe){return void 0===fe&&(fe=!1),pe(this,void 0,void 0,function(){var Q,Z,ee,te,ne,re,oe,ie,ae,se;return he(this,function(e){switch(e.label){case 0:if(ce.nodeType!==Node.ELEMENT_NODE)return[2];if("none"===(Q=window.getComputedStyle(ce)).display||"hidden"===Q.visibility||"0"===Q.opacity||0===ce.offsetWidth||0===ce.offsetHeight)return[2];if(ne=ce.getBoundingClientRect(),Z=ne.left+window.scrollX,ee=ne.top+window.scrollY,te=ne.width,ne=ne.height,!fe&&(Z+te<0||ee+ne<0||Z>window.innerWidth||ee>window.innerHeight))return[2];le.save(),e.label=1;case 1:return e.trys.push([1,10,11,12]),(re=parseFloat(Q.opacity))<1&&(le.globalAlpha=re),re=parseFloat(Q.borderRadius)||0,O=le,x=Z,P=ee,L=te,C=ne,void 0===(k=re)&&(k=0),(F=Q.boxShadow)&&"none"!==F&&(O.save(),(F=F.match(/(-?\d+(?:\.\d+)?(?:px)?)\s+(-?\d+(?:\.\d+)?(?:px)?)\s+(-?\d+(?:\.\d+)?(?:px)?)\s*(?:(-?\d+(?:\.\d+)?(?:px)?)\s*)?(rgba?\([^)]+\)|#[0-9a-f]{3,6}|[a-z]+)/i))&&(I=parseFloat(F[1])||0,A=parseFloat(F[2])||0,M=parseFloat(F[3])||0,N=F[4]?parseFloat(F[4]):0,F=F[5]||"rgba(0, 0, 0, 0.1)",O.shadowOffsetX=I,O.shadowOffsetY=A,O.shadowBlur=M,O.shadowColor=F,O.fillStyle="rgba(0, 0, 0, 0)",0<k?(O.beginPath(),Vn(O,x,P,me.add(L,me.times(N,2)),me.add(C,me.times(N,2)),k),O.fill()):O.fillRect(x,P,me.add(L,me.times(N,2)),me.add(C,me.times(N,2))),O.shadowOffsetX=0,O.shadowOffsetY=0,O.shadowBlur=0,O.shadowColor="transparent"),O.restore()),[4,function(o,i,a,s,l,c,u){return void 0===u&&(u=0),pe(this,void 0,void 0,function(){var t,n,r;return he(this,function(e){switch(e.label){case 0:return t=!1,o.save(),0<u&&(o.beginPath(),Vn(o,a,s,l,c,u),o.clip()),(n=i.backgroundImage)&&"none"!==n&&(n.includes("gradient")&&(r=((e,t,n,r,o,i)=>{try{if(e.includes("linear-gradient")){var a=e.match(/linear-gradient\s*\(((?:[^()]+|\([^)]*\))+)\)/);if(!a)return null;for(var s=a[1],l=[],c="",u=0,d=0;d<s.length;d++){var f=s[d];"("===f&&(u+=1),")"===f&&--u,","===f&&0===u?(l.push(c.trim()),c=""):c+=f}c&&l.push(c.trim());var p,h=180,m=l,g=l[0],v=(g.includes("deg")?(h=parseFloat(g),m=l.slice(1)):g.includes("to ")?((p=g.toLowerCase()).includes("to right")?h=90:p.includes("to left")?h=270:p.includes("to top")?h=0:p.includes("to bottom")?h=180:p.includes("to bottom right")?h=135:p.includes("to bottom left")?h=225:p.includes("to top right")?h=45:p.includes("to top left")&&(h=315),m=l.slice(1)):g.match(/^(#|rgb|hsl|[a-z]+)/i)||(m=l.slice(1)),me.divide(me.times(me.minus(h,90),Math.PI),180)),y=me.add(Math.abs(me.times(r,Math.cos(v))),Math.abs(me.times(o,Math.sin(v)))),w=me.minus(me.add(t,me.divide(r,2)),me.divide(me.times(Math.cos(v),y),2)),b=me.minus(me.add(n,me.divide(o,2)),me.divide(me.times(Math.sin(v),y),2)),E=me.add(me.add(t,me.divide(r,2)),me.divide(me.times(Math.cos(v),y),2)),R=me.add(me.add(n,me.divide(o,2)),me.divide(me.times(Math.sin(v),y),2)),S=i.createLinearGradient(w,b,E,R);return 0===m.length?null:(m.forEach(function(e,t){var n,e=e.match(/^(#[0-9a-f]{3,6}|rgba?\([^)]+\)|hsla?\([^)]+\)|[a-z]+)\s*(\d+%)?/i);e&&(n=e[1],e=e[2]?me.divide(parseFloat(e[2]),100):me.divide(t,Math.max(m.length-1,1)),S.addColorStop(e,n))}),S)}}catch(e){}return null})(n,a,s,l,c,o))&&(o.fillStyle=r,0<u?o.fill():o.fillRect(a,s,l,c),t=!0),!t)&&(r=n.match(/url\(['"]?([^'"]+)['"]?\)/))?[4,function(n,r,o,i,a,s){return pe(this,void 0,void 0,function(){return he(this,function(e){return[2,new Promise(function(e){var t=new Image;t.onload=function(){try{n.drawImage(t,o,i,a,s)}catch(e){}e()},t.onerror=function(){return e()},t.src=r,setTimeout(function(){return e()},500)})]})})}(o,r[1],a,s,l,c)]:[3,2];case 1:e.sent(),t=!0,e.label=2;case 2:return!t&&i.backgroundColor&&"rgba(0, 0, 0, 0)"!==i.backgroundColor&&(o.fillStyle=ge(i.backgroundColor),0<u?o.fill():o.fillRect(a,s,l,c)),o.restore(),[2]}})})}(le,Q,Z,ee,te,ne,re)];case 2:return e.sent(),I=le,A=Q,M=Z,F=ee,k=te,x=ne,void 0===(P=re)&&(P=0),L=parseFloat(A.borderTopWidth)||parseFloat(A.borderWidth)||0,C=parseFloat(A.borderRightWidth)||parseFloat(A.borderWidth)||0,N=parseFloat(A.borderBottomWidth)||parseFloat(A.borderWidth)||0,O=parseFloat(A.borderLeftWidth)||parseFloat(A.borderWidth)||0,"none"===(A.borderStyle||"none")||0===L&&0===C&&0===N&&0===O||(I.save(),L===C&&C===N&&N===O?(T=A.borderColor||A.borderTopColor||"#000000",I.strokeStyle=ge(T),I.lineWidth=L,0<P?(I.beginPath(),Vn(I,me.add(M,me.divide(L,2)),me.add(F,me.divide(L,2)),me.minus(k,L),me.minus(x,L),P),I.stroke()):I.strokeRect(me.add(M,me.divide(L,2)),me.add(F,me.divide(L,2)),me.minus(k,L),me.minus(x,L))):(I.beginPath(),0<L&&(I.strokeStyle=ge(A.borderTopColor||A.borderColor||"#000000"),I.lineWidth=L,I.moveTo(M,me.add(F,me.divide(L,2))),I.lineTo(me.add(M,k),me.add(F,me.divide(L,2))),I.stroke()),0<C&&(I.strokeStyle=ge(A.borderRightColor||A.borderColor||"#000000"),I.lineWidth=C,I.beginPath(),I.moveTo(me.minus(me.add(M,k),me.divide(C,2)),F),I.lineTo(me.minus(me.add(M,k),me.divide(C,2)),me.add(F,x)),I.stroke()),0<N&&(I.strokeStyle=ge(A.borderBottomColor||A.borderColor||"#000000"),I.lineWidth=N,I.beginPath(),I.moveTo(M,me.minus(me.add(F,x),me.divide(N,2))),I.lineTo(me.add(M,k),me.minus(me.add(F,x),me.divide(N,2))),I.stroke()),0<O&&(I.strokeStyle=ge(A.borderLeftColor||A.borderColor||"#000000"),I.lineWidth=O,I.beginPath(),I.moveTo(me.add(M,me.divide(O,2)),F),I.lineTo(me.add(M,me.divide(O,2)),me.add(F,x)),I.stroke())),I.restore()),"hidden"!==(oe=Q.overflow)&&"scroll"!==oe&&"auto"!==oe||(le.save(),le.beginPath(),0<re?Vn(le,Z,ee,te,ne,re):le.rect(Z,ee,te,ne),le.clip()),"img"!==(ie=ce.tagName.toLowerCase())?[3,4]:[4,function(t,n,r,o,i,a){return pe(this,void 0,void 0,function(){return he(this,function(e){try{n.complete&&0<n.naturalWidth&&t.drawImage(n,r,o,i,a)}catch(e){t.strokeStyle="#cccccc",t.strokeRect(r,o,i,a),t.fillStyle="#f0f0f0",t.fillRect(r,o,i,a)}return[2]})})}(le,ce,Z,ee,te,ne)];case 3:return e.sent(),[3,5];case 4:if("canvas"===ie){var _=le;T=ce;var t=Z;var n=ee;var r=te;var o=ne;try{_.drawImage(T,t,n,r,o)}catch(_){}}else if("button"===ie||"input"===ie||"textarea"===ie)t=le,n=Q,r=Z,o=ee,v=te,y=ne,(Y=(g=ce).value||g.textContent||g.placeholder||"")&&(b=parseFloat(n.fontSize)||14,E=n.fontFamily.split(",")[0].replace(/['"]/g,"")||"Arial",w=n.fontWeight||"normal",t.fillStyle=ge(n.color||"#ffffff"),t.font=w+" "+b+"px "+E,w=parseFloat(n.paddingLeft)||10,b=parseFloat(n.paddingRight)||10,E=me.minus(v,w,b),R=n.display,S=n.justifyContent,n=n.textAlign,t.textBaseline="middle",o=me.add(o,me.divide(y,2)),y=("flex"===R||"inline-flex"===R)&&"center"===S||"center"===n||"button"===g.tagName.toLowerCase()?(t.textAlign="center",me.add(r,me.divide(v,2))):"right"===n?(t.textAlign="right",me.minus(me.add(r,v),b)):(t.textAlign="left",me.add(r,w)),t.fillText(Y,y,o,E));else{var i=le;var H=ce;R=Q;S=Z;g=ee;v=te;b=ne;try{for(var a,s,U,D,q,l,c,u,d,j,W,f,B,p,G,z,J,V,h,m,X=[],$=0;$<H.childNodes.length;$++){var K=H.childNodes[$];K.nodeType===Node.TEXT_NODE&&X.push(K)}0!==X.length&&((a=X.map(function(e){return e.textContent}).join("").trim())&&(s=parseFloat(R.fontSize)||16,U=R.fontFamily.split(",")[0].replace(/['"]/g,"")||"Arial",D=R.fontWeight||"normal",q=R.fontStyle||"normal",i.font=q+" "+D+" "+s+"px "+U,i.fillStyle=ge(R.color||"#000000"),l=parseFloat(R.paddingTop)||0,c=parseFloat(R.paddingBottom)||0,u=parseFloat(R.paddingLeft)||0,d=parseFloat(R.paddingRight)||0,j=me.minus(v,u,d),W=me.minus(b,l,c),p=void 0,m=void(p="flex"!==(f=R.display)&&"inline-flex"!==f||"center"!==R.alignItems?"middle"===(B=R.verticalAlign)?(i.textBaseline="middle",me.add(g,l,me.divide(W,2))):"bottom"===B?(i.textBaseline="bottom",me.minus(me.add(g,b),c)):(i.textBaseline="top",me.add(g,l)):(i.textBaseline="middle",me.add(g,me.divide(b,2)))),G=R.justifyContent,z=R.textAlign,m=("flex"===f||"inline-flex"===f)&&"center"===G||"center"===z?(i.textAlign="center",me.add(S,me.divide(v,2))):"right"===z||"flex-end"===G?(i.textAlign="right",me.minus(me.add(S,v),d)):(i.textAlign="left",me.add(S,u)),i.fillText(a,m,p,j),R.textDecoration)&&"none"!==R.textDecoration&&(J=i.measureText(a),V=Math.min(J.width,j),i.strokeStyle=ge(R.color||"#000000"),i.lineWidth=1,R.textDecoration.includes("underline")&&(h=me.add(p,s),i.beginPath(),i.moveTo(m,h),i.lineTo(me.add(m,V),h),i.stroke()),R.textDecoration.includes("line-through")))&&(h=me.add(p,me.divide(s,2)),i.beginPath(),i.moveTo(m,h),i.lineTo(me.add(m,V),h),i.stroke())}catch(i){}}e.label=5;case 5:ae=ce.children,se=0,e.label=6;case 6:return se<ae.length?[4,Xn(le,ae[se],ue,de,fe)]:[3,9];case 7:e.sent(),e.label=8;case 8:return se++,[3,6];case 9:return"hidden"!==oe&&"scroll"!==oe&&"auto"!==oe||le.restore(),[3,12];case 10:return e.sent(),[3,12];case 11:return le.restore(),[7];case 12:return[2]}var g,v,y,w,b,E,R,S,Y,T,O,x,P,L,C,k,I,A,M,N,F})})}var C=new n({name:"blankScreen",onNewAegis:function(I){var A,M,e,N,t,F,_,H,n,U,D,q,j,r,W,B,o,G,z,i,a,J,s,l,c,u,d,f,p,h,m,g,v,y,w=this;document.elementFromPoint&&(e=Bn(I),N=e.everySideSampleNumber,t=e.sameElementsPercent,F=e.containers,_=e.ignoreContainers,H=e.detectStartPosition,n=e.ignoreElesWhenDomChange,U=e.reDetectInterval,D=e.disableSameElementsCheck,q=e.samePointDepth,j=e.enableScreenshot,r=4*N-3,W=Math.floor(r*e.emptyElementsPercent/100),B=Math.floor(r*t/100),o=Un.UNKNOWN,z=null,i=G=!1,a=function(){return pe(w,void 0,void 0,function(){var o,i,a,d,f,p,h,m,g,v,y,w,b,E,R,S,T,O,x,P,L,C,k=this;return he(this,function(e){switch(e.label){case 0:if(o=window.innerHeight,i=window.innerWidth,a=H.x,d=H.y,i<=a||o<=d)return[2];for(f=a+(i-a)/2,p=d+(o-d)/2,h=[],m=N+1,g=0,v=1;v<m;v++)b=d+(o-d)*v/m,R=Gn(y=a+(i-a)*v/m,p),w=Gn(f,b),E=Gn(y,b),y=Gn(y,o-b),b=Wn(R,F,_),b.isWhitePoint&&(g+=1),h.push(b.selectorPointers),v!==m/2&&(R=Wn(w,F,_),b=R.isWhitePoint,w=R.selectorPointers,b&&(g+=1),R=Wn(E,F,_),b=R.isWhitePoint,E=R.selectorPointers,b&&(g+=1),R=Wn(y,F,_),R.isWhitePoint&&(g+=1),h.push(w,E,R.selectorPointers));return S=W<=g,T=!1,O={samePointerMap:{},maximumSamePointer:{}},D||(L=h.map(function(e){return e.slice(0,q)}),t=L.map(function(e){return e.join(" < ")}).reduce(function(e,t){return e[t]=e[t]?e[t]+1:1,e},{}),n=Object.keys(t).map(function(e){return[e,t[e]]}).sort(function(e,t){return t[1]-e[1]})[0],r=n[0],L={samePointerMap:t,maximumSamePointerClass:r,maximumSamePointerCounter:n[1]},O={samePointerMap:L.samePointerMap,maximumSamePointer:((C={})[x=L.maximumSamePointerClass]=L=L.maximumSamePointerCounter,C)},C=qn.some(function(e){return x.startsWith(e)}),T=B<=L&&!C),S||T?[3,1]:(G=!1,z=null,[3,7]);case 1:if(!G)return[3,6];if(P=null,!j)return[3,5];e.label=2;case 2:return e.trys.push([2,4,,5]),[4,(void 0===s&&(s=.1),void 0===l&&(l="image/webp"),void 0===c&&(c=1920),void 0===u&&(u=1080),pe(void 0,void 0,void 0,function(){var t,n,r,o,i,a;return he(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=document.createElement("canvas"),(n=t.getContext("2d",{alpha:!1,willReadFrequently:!1}))?(r=window.innerWidth,c<r&&(r=c),u<(o=window.innerHeight)&&(o=u),t.width=me.times(r,.3),t.height=me.times(o,.3),n.scale(.3,.3),i=window.getComputedStyle(document.body),i=i.backgroundColor,a=!i||"rgba(0, 0, 0, 0)"===i||"transparent"===i,n.fillStyle=a?"#ffffff":ge(i),n.fillRect(0,0,r,o),[4,Xn(n,document.body,0,0,!0)]):[2,null];case 1:return e.sent(),[2,t.toDataURL(l,s)];case 2:return e.sent(),[2,null];case 3:return[2]}})}))];case 3:return(L=e.sent())&&L.length<=20480&&(P=L),[3,5];case 4:return e.sent(),[3,5];case 5:return C={msg:"decect blankscreen whitePointCount: "+(null==z?void 0:z.whitePointCount)+" whitePointerThreshold: "+W+" reDetectInterval: "+U+"\n\nlinkError: "+(null==z?void 0:z.linkMsg),level:X.BLANK_SCREEN,errorMsg:P||null,originFrom:I.getOriginFrom()},I.normalLogPipeline(C),G=!1,z=null,[3,7];case 6:z=V(V({msg:"blank_screen",level:X.BLANK_SCREEN,whitePointCount:g},O),A?{linkLogType:null==A?void 0:A.type,linkLogLevel:null==A?void 0:A.level,linkErrorMsg:null==A?void 0:A.errorMsg,linkMsg:null==A?void 0:A.msg}:{}),G=!0,M=setTimeout(function(){return pe(k,void 0,void 0,function(){return he(this,function(e){switch(e.label){case 0:return[4,J()];case 1:return e.sent(),[2]}})})},U),e.label=7;case 7:return[2]}var t,n,r,s,l,c,u})})},J=function(){return pe(w,void 0,void 0,function(){var n=this;return he(this,function(e){switch(e.label){case 0:return"requestIdleCallback"in window?(window.requestIdleCallback(function(t){return pe(n,void 0,void 0,function(){return he(this,function(e){switch(e.label){case 0:return 0<t.timeRemaining()?[4,a()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),[3,3]):[3,1];case 1:return[4,a()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},s=function(){var e;G||o===Un.ERROR&&!A||(o=A?Un.ERROR:Un.DOM_CHANGE,clearTimeout(M),e=Bn(I).debounceDuration,M=setTimeout(function(){return pe(w,void 0,void 0,function(){return he(this,function(e){switch(e.label){case 0:return clearTimeout(M),[4,J()];case 1:return e.sent(),[2]}})})},e))},I.lifeCycle.on("errorOccurred",l=function(e){e=e.filter(function(e){return e.level!==X.BLANK_SCREEN});0<e.length&&(A=e[e.length-1],s())}),c=null,window.MutationObserver&&(m=g=null,u=window.cancelAnimationFrame||function(e){clearTimeout(e)},d=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},f=function(){(c=new MutationObserver(function(e){var t=n.includes(zn(e[0].target));1===e.length&&t||s()})).observe(document.body,{childList:!0,subtree:!0})},p=function(){g&&(clearTimeout(g),g=null),m&&(u(m),m=null)},document.body?f():(m=d(h=function(){document.body?(p(),f()):m=d(h)}),g=setTimeout(function(){p()},1e4))),v=function(){i&&(i=!0,G)&&(clearTimeout(M),a())},y=function(){"visible"===document.visibilityState&&(i=!1),"hidden"===document.visibilityState&&v()},window.addEventListener("pagehide",v),window.addEventListener("beforeunload",v),window.addEventListener("visibilitychange",y),this.destroyBlanckScreenDetect=function(){window.removeEventListener("pagehide",v),window.removeEventListener("beforeunload",v),window.removeEventListener("visibilitychange",y),I.lifeCycle.remove("errorOccurred",l),null!=c&&c.disconnect()})},destroy:function(){this.destroyBlanckScreenDetect()}}),$n=(new n({name:"lagMonitor"}),new n({name:"lagMonitor",observer:null,lagRecords:[],onNewAegis:function(e){var t,n=this.$getConfig(e);n&&n.enabled&&"undefined"!=typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")&&(t=n.sampleRate||1,Math.random()<t)&&this.initLagMonitor(e,n)},initLagMonitor:function(n,e){var r=this,o=e.threshold||2e3,i=e.noResponseThreshold||5e3;try{this.observer=new PerformanceObserver(function(e){e.getEntries().forEach(function(e){var t;e.duration>o&&(t=e.scripts&&0<e.scripts.length?e.scripts[0]:null,e={name:e.name,timestamp:Date.now(),entryType:e.entryType,startTime:e.startTime,duration:e.duration,invoker:null==t?void 0:t.invoker,sourceURL:null==t?void 0:t.sourceURL},r.lagRecords.push(e),100<r.lagRecords.length&&r.lagRecords.shift(),r.publishLagLog(e,n,i<=e.duration))})}),this.observer.observe({type:"long-animation-frame",buffered:!1}),"undefined"!=typeof window&&(window.__longTasks=this.lagRecords)}catch(n){if("undefined"!=typeof console&&console.warn&&console.warn("Lag monitor initialization failed:",n),this.observer){try{this.observer.disconnect()}catch(n){}this.observer=null}}},publishLagLog:function(n,r,o){void 0===o&&(o=!1);try{this.$walk(function(e){if(e===r){var t={msg:JSON.stringify({type:o?"NORESPONSE_DETECTED":"LAG_DETECTED",duration:Math.round(100*n.duration)/100,startTime:Math.round(100*n.startTime)/100,entryType:n.entryType,sourceURL:n.sourceURL||"unknown",invoker:n.invoker||"unknown",timestamp:n.timestamp}),level:o?X.NORESPONSE_LOG:X.LAG_MONITOR,time:n.timestamp,originFrom:e.getOriginFrom()};try{e.normalLogPipeline(t)}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("Lag log pipeline failed:",e)}}})}catch(n){"undefined"!=typeof console&&console.warn&&console.warn("Lag log publish failed:",n)}},getLagRecords:function(){return u(this.lagRecords)},clearLagRecords:function(){this.lagRecords.length=0,"undefined"!=typeof window&&(window.__longTasks=[])},destroy:function(){if(this.observer){try{this.observer.disconnect()}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("Observer disconnect failed:",e)}this.observer=null}this.clearLagRecords()}}));function Kn(){try{return"undefined"!=typeof window&&window.performance&&window.performance.memory&&"number"==typeof window.performance.memory.usedJSHeapSize}catch(e){}}function Yn(){try{var e,t,n;return Kn()?(t=(e=window.performance.memory).usedJSHeapSize||0,n=e.jsHeapSizeLimit||0,{usedJSHeapSize:t,totalJSHeapSize:e.totalJSHeapSize||0,jsHeapSizeLimit:n,usageRatio:0<n?Math.round(t/n*1e4)/100:0,timestamp:Date.now()}):null}catch(e){return null}}function Qn(e){return Math.round(e/1048576*100)/100}new n({name:"memoryMonitor"});n=new n({name:"memoryMonitor",memoryReportTimer:null,oomCheckTimer:null,lastOOMTime:0,memoryRecords:[],onNewAegis:function(e){var t,n,r=this.$getConfig(e);r&&r.enabled&&Kn()&&(t=r.sampleRate||1,Math.random()<t)&&(!(t=r.monitorPages)||0===t.length||(n="undefined"!=typeof window?window.location.href:"",t.some(function(e){return"string"==typeof e?n.includes(e):e instanceof RegExp&&e.test(n)})))&&this.initMemoryMonitor(e,r)},initMemoryMonitor:function(e,t){var n,r=this,o=!1!==t.enableMemoryReport,i=!1!==t.enableOOMReport,a=t.memoryReportInterval||6e4,s=t.oomCheckInterval||1e4,l=t.oomThreshold||(()=>{try{var e,t;return Kn()?0<(e=window.performance.memory.jsHeapSizeLimit||0)?(t=Qn(e),Math.round(.9*t)):100:100}catch(e){return 100}})();try{o&&(this.memoryReportTimer=setInterval(function(){r.reportCurrentMemory(e,"MEMORY_REPORT")},a)),i&&(this.oomCheckTimer=setInterval(function(){r.checkOOMCondition(e,l)},s)),"undefined"!=typeof window&&(window.addEventListener("beforeunload",n=function(){r.cleanup()}),window.addEventListener("pagehide",n))}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("Memory monitor initialization failed:",e),this.cleanup()}},reportCurrentMemory:function(e,t){try{var n,r=Yn();r&&(n={type:t,memoryInfo:r,url:"undefined"!=typeof window?window.location.href:"",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"",timestamp:Date.now()},this.memoryRecords.push(n),50<this.memoryRecords.length&&this.memoryRecords.shift(),this.publishMemoryLog(n,e))}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("Memory report failed:",e)}},checkOOMCondition:function(e,t){try{var n,r,o=Yn();o&&(n=Qn(o.usedJSHeapSize),r=Date.now(),t<n)&&3e5<r-this.lastOOMTime&&(this.lastOOMTime=r,this.reportCurrentMemory(e,"MEMORY_OOM"))}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("OOM check failed:",e)}},publishMemoryLog:function(e,t){try{"MEMORY_REPORT"===e.type?this.publishMemoryReport(e,t):"MEMORY_OOM"===e.type&&this.publishOOMLog(e,t)}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("Memory log publish failed:",e)}},publishMemoryReport:function(e,t){try{var n={memoryUsed:e.memoryInfo.usedJSHeapSize,memoryAllocated:e.memoryInfo.totalJSHeapSize,memoryUsage:e.memoryInfo.usageRatio};this.$walk(function(o){var e;if(o===t)try{null!=(e=o.sendPipeline)&&e.call(o,[function(n,e){var t=o.config.memoryUrl||o.config.hostUrl+"/memory",r=new URLSearchParams;Object.keys(n).forEach(function(e){var t=n[e];null!=t&&""!==t&&r.append(e,String(t))}),e({url:t+"?"+r.toString(),method:"post",type:m.MEMORY,log:n,success:function(){"undefined"!=typeof console&&console.debug&&console.debug("Memory report success:",n.memory_used,"bytes")},fail:function(e){"undefined"!=typeof console&&console.warn&&console.warn("Memory report failed:",e)}})}],m.MEMORY)(n)}catch(o){"undefined"!=typeof console&&console.warn&&console.warn("Memory pipeline failed:",o)}})}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("Memory report publish failed:",e)}},publishOOMLog:function(e,n){try{var t=e.memoryInfo,r="Memory OOM detected: Used "+Qn(t.usedJSHeapSize)+"MB / Total "+Qn(t.totalJSHeapSize)+"MB / Limit "+Qn(t.jsHeapSizeLimit)+"MB ("+t.usageRatio+"%)",o={msg:r,level:X.MEMORY_OOM,time:e.timestamp,originFrom:n.getOriginFrom()};this.$walk(function(e){var t;if(e===n)try{null!=(t=e.normalLogPipeline)&&t.call(e,o),"undefined"!=typeof console&&console.warn&&console.warn("OOM detected and reported:",r)}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("OOM pipeline failed:",e)}})}catch(e){"undefined"!=typeof console&&console.warn&&console.warn("OOM log publish failed:",e)}},getMemoryRecords:function(){return u(this.memoryRecords)},getCurrentMemoryStatus:Yn,clearMemoryRecords:function(){this.memoryRecords.length=0},cleanup:function(){this.memoryReportTimer&&(clearInterval(this.memoryReportTimer),this.memoryReportTimer=null),this.oomCheckTimer&&(clearInterval(this.oomCheckTimer),this.oomCheckTimer=null)},destroy:function(){this.cleanup(),this.clearMemoryRecords(),this.lastOOMTime=0}});return e.use(Pt),e.use(bt),e.use(Be),e.use(Mn),e.use(kn),e.use(je),e.use(f),e.use(Fn),e.use(Hn),e.use(At),e.use(Nt),e.use($n),e.use(n),e.use(Rt),e.use(C),e});
